<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="UTF-8">
<meta name="application-name" content="Crypto Dash">
<meta name="description" content="Crypto Currency Tracker Dashboard">
<meta name="keywords" content="HTML, CSS, JavaScript, Crypto">
<meta name="author" content="Mihail-Vlad Prajescu">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Bootstrap 5.1.3 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" type="text/css">

<!-- Tom Select 2.0.0 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tom-select@2.0.0/dist/css/tom-select.bootstrap5.min.css" type="text/css">

<!-- FontAwesome 4.6.3 CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">

<!-- Toastify Javascript -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" type="text/css">

<!-- Pace JS CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@latest/pace-theme-default.min.css">

<!-- Animate.style CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

<!-- Pace JS -->
<script data-pace-options='{ "ajax": true }' src="https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js"></script>

<!-- Muuri 0.9.5 JS -->
<script src="https://cdn.jsdelivr.net/npm/muuri@0.9.5/dist/muuri.min.js"></script>

<!-- Web Animations 2.3.2 JS -->
<script src="https://cdn.jsdelivr.net/npm/web-animations-js@2.3.2/web-animations.min.js"></script>

<!-- Big Number JS 9.0.1 JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bignumber.js/9.0.1/bignumber.min.js"></script>

<!-- Toastify JS-->
<script  src="https://cdn.jsdelivr.net/npm/toastify-js" type="text/javascript"></script>

<!-- Apex Charts JS-->
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<!-- Maybe implement themes in the future -->
<!-- Themes from https://bootswatch.com/ -->
<!--<link href="https://bootswatch.com/5/materia/bootstrap.min.css" rel="stylesheet">-->

<!-- // USD/GBP/EUR 
// Last hour comparison 
// 24 hours comparison-->

<title> Crypto Dash </title>

<style>

* {
    box-sizing: border-box;
}

body {
	font-family: sans-serif;
	margin-left: 40px;
  margin-right: 40px;
  margin-top: 60px;
  margin-bottom: 40px;
  background-size: 110%;
  background: #282537 no-repeat center fixed;  
  background-image: -webkit-radial-gradient(top, circle cover, #3c3b52 0%, #252233 80%);
  background-image: -moz-radial-gradient(top, circle cover, #3c3b52 0%, #252233 80%);
  background-image: -o-radial-gradient(top, circle cover, #3c3b52 0%, #252233 80%);
  background-image: radial-gradient(top, circle cover, #3c3b52 0%, #252233 80%);
  background-size: cover;
}

/* custom Bootstrap changes */
.btn:not(#cryptodash-apikey-button) {
  border: 0px !important;
}
.modal-body, .modal-footer, .tab-content label:not(.badge) {
  font-size: 0.875rem;
}
.modal-content {
  border-radius: 1rem;
}

.modal-header {
  border-bottom: none !important;
}

.modal-footer {
  border-top : none !important;
}


/* *** BACKGROUND AND COLORS *** */

/* color variables for frost and simple background */
:root {
  --frosted-bg-color: rgba(255, 255, 255, 0.25);
  --frosted-tracker-bg-color: rgba(255, 255, 255, 0.25);
  --cryptodash-main-bg-color: #282537;
  --cryptodash-gradient-bg-color-1: #3c3b52;
  --cryptodash-gradient-bg-color-2: #252233;
}

/* simple background class */
.cryptodash-bg-simple {
  background-size: 110%;
  background: #282537 no-repeat center fixed;  
  background-image: -webkit-radial-gradient(top, circle cover, #3c3b52 0%, #252233 80%);
  background-image: -moz-radial-gradient(top, circle cover, #3c3b52 0%, #252233 80%);
  background-image: -o-radial-gradient(top, circle cover, #3c3b52 0%, #252233 80%);
  background-image: radial-gradient(top, circle cover, #3c3b52 0%, #252233 80%);
  background-size: cover;
}

/* random simple background class */
.cryptodash-bg-custom {
  background-size: 110%;
  background: var(--cryptodash-main-bg-color) no-repeat center fixed; ;
  background-image: -webkit-radial-gradient(top, circle cover, var(--cryptodash-gradient-bg-color-1) 0%, var(--cryptodash-gradient-bg-color-2) 80%);
  background-image: -moz-radial-gradient(top, circle cover, var(--cryptodash-gradient-bg-color-1) 0%, var(--cryptodash-gradient-bg-color-2) 80%);
  background-image: -o-radial-gradient(top, circle cover, var(--cryptodash-gradient-bg-color-1) 0%, var(--cryptodash-gradient-bg-color-2) 80%);
  background-image: radial-gradient(top, circle cover, var(--cryptodash-gradient-bg-color-1) 0%, var(--cryptodash-gradient-bg-color-2) 80%);
  background-size: cover;
}

/* gradient HD background class */
.cryptodash-bg-image-gradient-hd {
  background-size: 110%;
	background: url(https://source.unsplash.com/1920x1080/?gradient) no-repeat center fixed;
  /* background-image: url(https://source.unsplash.com/1920x1080/?gradient);
  background-repeat: no-repeat;
  background-position: center;
  background-attachment: fixed; */
  background-size: cover;
}

/* abstract HD background class */
.cryptodash-bg-image-abstract-hd {
  background-size: 110%;
	background: url(https://source.unsplash.com/1920x1080/?abstract) no-repeat center fixed;     
  background-size: cover;
}

/* gradient 4K background class */
.cryptodash-bg-image-gradient-4k {
  background-size: 110%;
	background: url(https://source.unsplash.com/3840x2160/?gradient) no-repeat center fixed;     
  background-size: cover;
}

/* abstract 4K background class */
.cryptodash-bg-image-abstract-4k {
  background-size: 110%;
	background: url(https://source.unsplash.com/3840x2160/?abstract) no-repeat center fixed;     
  background-size: cover;
}


/* *** GRID *** */

/* grid style */
.cryptodash-grid {
  position: relative;
}

/* tracker draging */
.cryptodash-tracker.muuri-item-dragging {
  z-index: 3;
}
.cryptodash-tracker.muuri-item-releasing {
  z-index: 2;
}
.cryptodash-tracker.muuri-item-hidden {
  z-index: 0;
}


/* tracker style */
.cryptodash-tracker {
  display: block;
  position: absolute;
  width: 420px;
  height: 210px;
  margin: 20px;
  padding: 5px;
  z-index: 1;
  border-radius: 1rem;
  box-shadow:  0px 0px 30px 5px rgba(0, 0, 0, 0.3),0px 0px 10px -30px rgba(0, 0, 0, 0.3),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 30px 5px rgba(0, 0, 0, 0.3),0px 0px 10px -30px rgba(0, 0, 0, 0.3),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 30px 5px rgba(0, 0, 0, 0.3),0px 0px 10px -30px rgba(0, 0, 0, 0.3),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
  background-size: cover;
  font-size: calc(3 vw + 3 vh);
}

.cryptodash-tracker:before {
  content: "";
  position: absolute;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  /*background-color: var(--frosted-tracker-bg-color);
  backdrop-filter: blur(2px); 
  backdrop-filter: blur(45px);*/
  border-radius: 1rem;
  padding: 5px;
}

/* tracker content style */
.cryptodash-tracker-content {
  border-radius: 1rem;
  position: relative;
  width: 100%;
  height: 100%;
  align-items: center;
  justify-content: center;
  background-size: cover;
  padding-left:10px;
  padding-right:10px;
  padding-top: 5px;
  padding-bottom: 5px;
}

/* tracker content image logo style */
.cryptodash-tracker-content img {
  width: calc(100% - 85%);
  height: auto;
  position: absolute;
  top: calc(100% - 92%);
  right: calc(100% - 96%);
  border-radius: 50%;
}

/* all cryptodash tracker content paragraphs that are not containing the update time */
.cryptodash-tracker-content p:not(p[id$="updatetime"]) {
  font-size: 0.7em;
  margin-bottom: 0px !important;
}

/* cryptodash tracker content paragraph that is specifically targeting the last 24 hours change in percent element with a dynamically built ID attribute ending with a specific value in ID */
p[id$="changepct24"] {
  bottom: calc(100% - 81%);
  position: absolute;
}

/* cryptodash tracker content paragraph that is specifically targeting the last hour change in percent element with a dynamically built ID attribute ending with a specific value in ID */
p[id$="changepcthour"] {
  bottom: calc(100% - 97%);
  position: absolute;
}

/* cryptodash tracker title in H1 */
.cryptodash-tracker-content h1 {
  font-size: 1.3em;
  font-weight: bold;
}
/* cryptodash tracker price in H2 */
.cryptodash-tracker-content h2 {
  font-size: 1.2em;
  margin-bottom: 0.2rem;
}

/* cryptodash tracker content paragraph that is specifically targeting the updated time element with a dynamically created ID*/
p[id$="updatetime"] {
  bottom: calc(100% - 97%);
  right: 10px;
  position: absolute;
  left: auto;
  text-align: center; 
  margin-bottom: 0px !important;
  font-size: 0.7em;
}


/* *** Charts *** */

/* make the chart menu offcanvas full screen */
#cryptodash-chart-menu {
  height: calc(100vh); 
}

/* custom Apex charts changes */

/* transparent background to aid in frosting the interface */
.apexcharts-canvas {
  background: none !important;
}

/* toolbar icons fill to black so it will blend better with frosted background */
.apexcharts-zoom-icon svg, .apexcharts-zoomin-icon svg, .apexcharts-zoomout-icon svg, .apexcharts-reset-icon svg, .apexcharts-menu-icon svg {
  /* fill: #6E8192; */
  fill: #000000;
}

/* setting up the charts with some space in the content */
#cryptodash-30-days-chart-content {
  padding-bottom: 10px;
}

#cryptodash-1-day-chart-content {
  padding-bottom: 10px;
}

#cryptodash-1-hour-chart-content {
  padding-bottom: 10px;
}





/* cryptodash tracker positive pulsing shadow animation for image element */
.cryptodash-positive {
  animation: pulsate-img-green 1.5s ease-in infinite;
  box-shadow:  0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);  
}

/* cryptodash tracker positive pulsing shadow animation for the whole tracker card */
.cryptodash-content-positive {
  animation: pulsate-in-green 1.5s ease-in infinite;
  box-shadow:  inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 10px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 10px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 10px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); 
}

/* cryptodash tracker growing animation for the tracker image and used in the negative effect */
.cryptodash-positive-pulse {
  animation: grow 0.75s alternate infinite ease-in;
}

/* cryptodash tracker negative shadow animation for the tracker image on the card */
.cryptodash-negative {
  animation: pulsate-red 5s ease-out, grow 2.5s ease-out;
  box-shadow:  0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); 
}


/* animations */

@keyframes pulsate-green {
  0%   { box-shadow:  0px 0px 20px 10px rgba(0, 255, 0, 0.7),0px 0px 30px -30px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 20px 10px rgba(0, 255, 0, 0.7),0px 0px 30px -30px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 20px 10px rgba(0, 255, 0, 0.7),0px 0px 30px -30px rgba(0, 0, 255, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }

  50%  { box-shadow:  0px 0px 30px 20px rgba(0, 255, 0, 0.7),0px 0px 30px -10px rgba(0, 255, 0, 0.2),0px 0px 6px 5px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 30px 20px rgba(0, 255, 0, 0.7),0px 0px 30px -10px rgba(0, 255, 0, 0.2),0px 0px 6px 5px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 30px 20px rgba(0, 255, 0, 0.7),0px 0px 30px -10px rgba(0, 0, 255, 0.2),0px 0px 6px 5px rgba(0, 0, 0, 0.2); }

  100% { box-shadow:  0px 0px 20px 10px rgba(0, 255, 0, 0.7),0px 0px 30px -30px rgba(0, 0, 255, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 20px 10px rgba(0, 255, 0, 0.7),0px 0px 30px -30px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 20px 10px rgba(0, 255, 0, 0.7),0px 0px 30px -30px rgba(0, 0, 255, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }
}

@keyframes pulsate-img-green {
  0%   { box-shadow:  0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }
    
  25%  { box-shadow: 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }  

  50%  { box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }

  75%  { box-shadow: 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); } 

  100% { box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }
}

@keyframes pulsate-in-green {
  0%   { box-shadow:  inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }
    
  25%  { box-shadow:  inset 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: inset 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: inset 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }  

  50%  { box-shadow:  inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }

  75%  { box-shadow:  inset 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: inset 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: inset 0px 0px 10px 3px rgba(0, 255, 0, 0.7),0px 0px 20px 3px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); } 

  100% { box-shadow:  inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: inset 0px 0px 10px 1px rgba(0, 255, 0, 0.7),0px 0px 20px 1px rgba(0, 255, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }
}

@keyframes pulsate-red {
  0%   { box-shadow:  0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }

  50%  { box-shadow:  0px 0px 30px 20px rgba(255, 0, 0, 0.7),0px 0px 30px -10px rgba(255, 0, 0, 0.2),0px 0px 6px 5px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 30px 20px rgba(255, 0, 0, 0.7),0px 0px 30px -10px rgba(255, 0, 0, 0.2),0px 0px 6px 5px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 30px 20px rgba(255, 0, 0, 0.7),0px 0px 30px -10px rgba(255, 0, 0, 0.2),0px 0px 6px 5px rgba(0, 0, 0, 0.2); }

  100% { box-shadow:  0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -webkit-box-shadow: 0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 20px 10px rgba(255, 0, 0, 0.7),0px 0px 30px -30px rgba(255, 0, 0, 0.2),0px 0px 6px 3px rgba(0, 0, 0, 0.2); }
}

@keyframes grow {
  0%   {transform: scale(1);}
  100% {transform: scale(1.1);}
}

















/* FROSTED */

/* offcanvas, modals and other elements frosted effect class */
.backdrop-blur {
  background-color: var(--frosted-bg-color);
}
 
/* if backdrop support: very transparent and blurred */
@supports ((-webkit-backdrop-filter: blur(1em)) or (backdrop-filter: blur(1em))) {
  .backdrop-blur {
    background-color: var(--frosted-bg-color);
    -webkit-backdrop-filter: blur(1em);
    backdrop-filter: blur(1em);
  }
}

/* tracker frosted effect */
.tracker-backdrop-blur {
  background-color: var(--frosted-tracker-bg-color);
}

/* if backdrop support: very transparent and blurred */
@supports ((-webkit-backdrop-filter: blur(1em)) or (backdrop-filter: blur(1em))) {
  .tracker-backdrop-blur {
    background-color: var(--frosted-tracker-bg-color);
    -webkit-backdrop-filter: blur(1em);
    backdrop-filter: blur(1em);
  }
}

/* settings menu button shadow */
#cryptodash-settings-menu {
  box-shadow:
    0px 0px 1.1px rgba(0, 0, 0, 0.02),
    0px 0px 2.7px rgba(0, 0, 0, 0.028),
    0px 0px 5px rgba(0, 0, 0, 0.035),
    0px 0px 8.9px rgba(0, 0, 0, 0.042),
    0px 0px 16.7px rgba(0, 0, 0, 0.05),
    0px 0px 40px rgba(0, 0, 0, 0.07)
  ;
}

 

/* *** Loader *** */
.pace {
	-webkit-pointer-events: none;
	pointer-events: none;

	-webkit-user-select: none;
	-moz-user-select: none;
	user-select: none;
}

.pace-inactive {
	display: none;
}

.pace .pace-progress {
	background: #29d;
	position: fixed;
	z-index: 2000;
	top: 0;
	right: 100%;
	width: 100%;
	height: 2px;
}


/*


#cryptodash-loader {
  background: white;
  padding: 16px 24px;
  position:fixed;
  top:50%;
  left:50%;
  border-radius: 8px;
  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.01);
}
#cryptodash-loader::after {
  position: absolute;
  content: "";
  top: 15px;
  left: 0;
  right: 0;
  z-index: -1;
  height: 100%;
  width: 100%;
  transform: scale(0.9) translateZ(0);
  filter: blur(15px);
  background: linear-gradient(to left, #ff5770, #e4428d, #c42da8, #9e16c3, #6501de, #9e16c3, #c42da8, #e4428d, #ff5770);
  background-size: 200% 200%;
  -webkit-animation: animateGlow 1.25s linear infinite;
          animation: animateGlow 1.25s linear infinite;
}

@-webkit-keyframes animateGlow {
  0% {
    background-position: 0% 50%;
  }
  100% {
    background-position: 200% 50%;
  }
}

@keyframes animateGlow {
  0% {
    background-position: 0% 50%;
  }
  100% {
    background-position: 200% 50%;
  }
}


*/



#cryptodash-loader{
  width:100px;
  height:80px;
  position:fixed;
  top:50%;
  left:50%;
  margin-top:-40px;
  margin-left:-50px;
}
  
.cryptodash-loader-inner{
  -webkit-animation:rotate 0.8s linear infinite;
  -moz-animation:rotate 0.8s linear infinite;
  animation:rotate 0.8s linear infinite;
  margin-top:20px;
  border-radius:50%;
  width:50px;
  height:50px;
  position:absolute;
}
  
.cryptodash-rotate-one{
  left:50%;
  margin-left:-25px;
  border-top:2px solid #1f6d8f;
}
  
.cryptodash-rotate-two{
  top:-10px;
  left:30px;
  border-left:2px solid #1f6d8f;
}
  
.cryptodash-rotate-three{
  top:-10px;
  right:30px;
  border-right:2px solid #1f6d8f;
}
  
@-webkit-keyframes rotate{
  0%{-webkit-transform:rotateZ(0deg);}
  100%{-webkit-transform:rotateZ(360deg);}
}
  
@-moz-keyframes rotate{
  0%{-moz-transform:rotateZ(0deg);}
  100%{-moz-transform:rotateZ(360deg);}
}
  
@keyframes rotate{
  0%{transform:rotateZ(0deg);}
  100%{transform:rotateZ(360deg);}
}



/* *** Crypto Dash Buttons *** */  

/* Settings Button */
#cryptodash-settings-button {
  top: -2px;
  left: -2px;
  z-index: 800;
  border-bottom-right-radius: 1rem;
  position: fixed;
  box-shadow:
    0px 0px 1.1px rgba(0, 0, 0, 0.02),
    0px 0px 2.7px rgba(0, 0, 0, 0.028),
    0px 0px 5px rgba(0, 0, 0, 0.035),
    0px 0px 8.9px rgba(0, 0, 0, 0.042),
    0px 0px 16.7px rgba(0, 0, 0, 0.05),
    0px 0px 40px rgba(0, 0, 0, 0.07)
  ;
}

/* Refresh Button */
#cryptodash-refresh-button {
  top: -2px;
  right: -2px;
  z-index: 800;
  border-bottom-left-radius: 1rem;
  position: fixed;
  box-shadow:
    0px 0px 1.1px rgba(0, 0, 0, 0.02),
    0px 0px 2.7px rgba(0, 0, 0, 0.028),
    0px 0px 5px rgba(0, 0, 0, 0.035),
    0px 0px 8.9px rgba(0, 0, 0, 0.042),
    0px 0px 16.7px rgba(0, 0, 0, 0.05),
    0px 0px 40px rgba(0, 0, 0, 0.07)
  ;
}


/* Settings Button */
#cryptodash-clock {
  top: -2px;
  left: calc(50vw - 100px);
  /* left: 5px;*/
  z-index: 800;
  width: 200px;
  text-align: center;
  border-bottom-left-radius: 1rem;
  border-bottom-right-radius: 1rem;
  position: fixed;
  box-shadow:
    0px 0px 1.1px rgba(0, 0, 0, 0.02),
    0px 0px 2.7px rgba(0, 0, 0, 0.028),
    0px 0px 5px rgba(0, 0, 0, 0.035),
    0px 0px 8.9px rgba(0, 0, 0, 0.042),
    0px 0px 16.7px rgba(0, 0, 0, 0.05),
    0px 0px 40px rgba(0, 0, 0, 0.07)
  ;
}


.ts-control, .ts-wrapper.single.input-active .ts-control {
  background: none !important;
}

.ts-dropdown, .ts-dropdown.form-control, .ts-dropdown.form-select {
  background: none !important;
}

.ts-dropdown {
  background: none !important;
}

#cryptodash-apikey {
  background: none !important;
  border: 1px solid #212529;
}
.input-group-text {
  background: none !important;
  border: 1px solid #212529;
}

.ts-control {
  border: 1px solid #565A5D;
  border-radius: 1rem;
  padding: 10px !important;
}

.accordion-item {
  background: none !important; 
  /* border: 1px solid rgba(0,0,0,.125); */
}
.accordion-button { 
  background: none !important; 
  border-radius: 1rem;
}

.toastify {
  background-image: unset;
  padding: 10px;
  margin: 10px;
  box-shadow: 0px 0px 30px 5px rgba(0, 0, 0, 0.3),0px 0px 10px -30px rgba(0, 0, 0, 0.3),0px 0px 6px 3px rgba(0, 0, 0, 0.2);
  border-radius: 1rem;
  transition: all .2s ease-in-out;
  width: 300px;
}

.toastify:hover {
  transform: scale(1.1);
}

.toast-close {
  opacity: 1;
  position: absolute;
  right: 5px;
}

</style>

</head>

<body>
  <noscript style="text-align: center;">
    
    <p class="text-white"><i class="fa fa-exclamation-triangle fa-5x"></i> <br> <br> Your browser doesn't support JavaScript or is turned off. <br> Please enable javascript or use a different browser, such as Google Chrome or Microsoft Edge. </p>
    <div style="text-align: center;">
      <a class="btn btn-outline-light btn-sm" href="https://www.microsoft.com/en-us/edge">Microsoft Edge</a>
      <a class="btn btn-outline-light btn-sm" href="https://www.google.com/intl/en_us/chrome/">Google Chrome</a>
    </div>
    
  </noscript>

<!-- Loader when page starts -->
<div id="cryptodash-loader">
  
    <div class="cryptodash-loader-inner cryptodash-rotate-one"></div>
    <div class="cryptodash-loader-inner cryptodash-rotate-two"></div>
    <div class="cryptodash-loader-inner cryptodash-rotate-three"></div>
   
</div>

<!-- Crypto Dashboard Main Content -->
<div id="cryptodash-content" style="opacity: 0;">

  <!-- Container grid where trackers are created dynamically-->
  <div class="cryptodash-grid row" id="CryptoDashContentTrackers">

  </div>

  <!-- Settings button -->
  <button id="cryptodash-settings-button" class="btn btn-lg btn-light backdrop-blur" type="button" data-bs-toggle="offcanvas" data-bs-target="#cryptodash-settings-menu" aria-controls="cryptodash-settings-menu">
    <i class="fa fa-cog fa-spin"></i>
  </button>

  <!-- Refresh button -->
  <button id="cryptodash-refresh-button" class="btn btn-lg btn-light backdrop-blur" type="button" aria-controls="refresh" onclick="manualCryptoDashFetchTrackerData()" hidden>
    <i id ="cryptodash-refresh-icon" class="fa fa-refresh "></i>
  </button>

  <!-- Clock -->
  <button id="cryptodash-clock" class="btn btn-lg backdrop-blur" type="button" aria-controls="cryptodash-clock">
    <i class="fa fa-clock-o"></i> 
  </button>
  
  <!-- Crypto Dash Settings Panel -->
  <div class="offcanvas offcanvas-start backdrop-blur" tabindex="-1" id="cryptodash-settings-menu" aria-labelledby="CryptoDashSettingsMenuLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="CryptoDashSettingsMenuLabel">

      Crypto Dashboard

    </h5>
      
      <button id="cryptodash-settings-menu-close" type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      
      <div id="blurrr">
        
      

      <!-- Crpyto Dash Settings Panel is split in 2 tabs -->

      <ul class="nav nav-pills nav-justified mb-3" id="cryptodash-settings-tab" role="tablist">
        <!-- Tracker and Data Button-->
        <li class="nav-item" role="presentation">
          <button class="btn btn-outline-dark btn-lg active" id="cryptodash-tracker-tab-button" data-bs-toggle="pill" data-bs-target="#cryptodash-tracker-tab" type="button" role="tab" aria-controls="cryptodash-tracker-tab" aria-selected="true"><i class="fa fa-th-large"></i> Trackers</button>
        </li>
        <!-- Customization Button-->
        <li class="nav-item" role="presentation">
          <button class="btn btn-outline-dark btn-lg" id="cryptodash-customize-tab-button" data-bs-toggle="pill" data-bs-target="#cryptodash-customize-tab" type="button" role="tab" aria-controls="cryptodash-customize-tab" aria-selected="false"><i class="fa fa-eye "></i> <br> Visual</button>
        </li>
        <!-- Help Button-->
        <li class="nav-item" role="presentation">
          <button class="btn btn-outline-dark btn-lg" id="cryptodash-help-tab-button" data-bs-toggle="pill" data-bs-target="#cryptodash-help-tab" type="button" role="tab" aria-controls="cryptodash-help-tab" aria-selected="false"><i class="fa fa-cog "></i> <br> Help </button>
        </li>
      </ul>

      <hr>

      <div class="tab-content" id="cryptodash-settings-tab-content">
        <!-- Tracker and Data Content-->
        <div class="tab-pane fade show active" id="cryptodash-tracker-tab" role="tabpanel" aria-labelledby="cryptodash-tracker-tab-button">
          
          <!-- Crpyto Dash Tracker -->
          <label for="cryptodash-setup" class="form-label badge bg-secondary"><i class="fa fa-tasks "></i> Crypto Setup</label>

          <div id="cryptodash-setup" class="gap-2">
            <!--<div id="cryptodash-setup-buttons" class="btn-group" role="group" aria-label="Trackers and Data Source"> -->
              <div class="row">
                <div class="col-6 d-flex justify-content-center">
                  <button type="button" class="btn btn-outline-dark btn-sm" data-bs-toggle="modal" data-bs-target="#manageCryptoDashDataSourceModal"><i class="fa fa-database "></i> <br> Data Source</button>  
                </div>
                <div class="col-6 d-flex justify-content-center">
                  <button type="button" class="btn btn-outline-dark btn-sm" data-bs-toggle="modal" data-bs-target="#manageCryptoDashCoinsModal"><i class="fa fa-th-large "></i> <br> Manage Trackers</button>
                </div>
              </div>

              <div class="accordion accordion-flush" id="cryptodash-data-and-trackers">

                <div class="accordion-item">
                  <h2 class="accordion-header" id="cryptodash-datasource-acc-title">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cryptodash-datasource-acc" aria-expanded="false" aria-controls="cryptodash-datasource-acc">
                      <i class="fa fa-database"></i>&nbspData Source
                    </button>
                  </h2>
                  <div id="cryptodash-datasource-acc" class="accordion-collapse collapse" aria-labelledby="cryptodash-datasource-acc-title" data-bs-parent="#cryptodash-data-and-trackers">
                    <div class="accordion-body">Placeholder content for this accordion, which is intended to demonstrate the <code>.accordion-flush</code> class. This is the first item's accordion body.</div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header" id="cryptodash-tracker-acc-title">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cryptodash-tracker-acc" aria-expanded="false" aria-controls="cryptodash-tracker-acc">
                      <i class="fa fa-th-large"></i>&nbspManage Trackers
                    </button>
                  </h2>
                  <div id="cryptodash-tracker-acc" class="accordion-collapse collapse" aria-labelledby="cryptodash-tracker-acc-title" data-bs-parent="#cryptodash-data-and-trackers">
                    <div class="accordion-body">
                    
                      


                    </div>
                  </div>
                </div>

              </div>














              <div id="cryptodash-rate-limit-datasource" class="d-grid gap-2 mt-3 mb-3">
                <button type="button" id="cryptodash-rate-limit-datasource-button" class="btn btn-outline-dark btn-sm" onclick="checkDataSourceRateLimit()"><i class="fa fa-signal"></i> Check Data Source Rate Limits</button>
                <div id="cryptodash-rate-limit-datasource-result">
      
                </div>
                
              </div>
            <!-- </div>-->
          </div>

          <hr>

          <!-- Currency Selector -->
          <label for="cryptodash-currency" class="form-label badge bg-secondary"><i class="fa fa-money"></i> Currency</label>
          <div id="cryptodash-currency" class="gap-2 d-flex justify-content-center"> 
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="cryptodash-currency" id="cryptodash-currency-usd" value="USD" checked>
              <label class="form-check-label" for="cryptodash-currency-usd">USD</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="cryptodash-currency" id="cryptodash-currency-eur" value="EUR">
              <label class="form-check-label" for="cryptodash-currency-eur">EUR</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="cryptodash-currency" id="cryptodash-currency-gbp" value="GBP">
              <label class="form-check-label" for="cryptodash-currency-gbp">GBP</label>
            </div>
          </div>

          <hr>

          <!-- Automatic Refresh Switch and Time Poll Interval Slider-->
          <label for="refreshRanger" class="form-label badge bg-secondary"><i class="fa fa-refresh "></i> Refresh rate: <span id="dataRefreshSpan"></span> </label>
          <div class="form-check form-switch">
            <label class="form-check-label" for="CryptoDashDataRefreshSwitch"> Data Auto Refresh </label>
            <input class="form-check-input" type="checkbox" id="CryptoDashDataRefreshSwitch"/>
          </div>

          
          <input type="range" class="form-range" min="110" max="1800" step="60" id="refreshRanger" data-bs-toggle="tooltip" data-bs-placement="top" title="" disabled>
          


        </div>

        <!-- Customization Content-->
        <div class="tab-pane fade" id="cryptodash-customize-tab" role="tabpanel" aria-labelledby="cryptodash-customize-tab-button">
          
          <!-- Customization -->

          <!-- 
            <div class="form-check form-switch">
            <label class="form-check-label" for="trackerAutoBackground"> Tracker Auto Background </label>
            <input class="form-check-input" type="checkbox" id="trackerAutoBackground"/>
          </div>
          
          -->

          <div class="row">
            <div class="col-6">

              <!-- Dark/Light Mode -->
              <div class="form-check form-switch" >
                <label class="form-check-label" for="CryptoDashLightSwitch"> <i class="fa fa-moon-o "></i> Dark Mode </label>
                <input class="form-check-input" type="checkbox" id="CryptoDashLightSwitch"/>
              </div>


            </div>

            <div class="col-6">
              
              <div class="form-check form-switch">
                <label class="form-check-label" for="frostedCryptoDashTheme"> <i class="fa fa-snowflake-o "></i> Frosted </label>
                <input class="form-check-input" type="checkbox" id="frostedCryptoDashTheme" checked/>
              </div>

            </div>

          </div>
          
          

          <hr>

          <!-- Grid Size -->
          <label for="itemSizeRanger" class="form-label badge bg-secondary"><i class="fa fa-th-large "></i> Tracker Size: <span id="gridsizeSpan"></span> </label>
          <input type="range" class="form-range" min="190" max="570" step="1" id="itemSizeRanger" data-bs-toggle="tooltip" data-bs-placement="top" title="">

          <hr>
          
          <!-- Notifications -->
          <label for="cryptoDashNotifications" class="form-label badge bg-secondary"><i class="fa fa-bell-o "></i> Notifications</label>

          


          <div id="cryptodash-notification-orientation" class="row d-flex justify-content-center"> 
          
            <div class="col-6 d-grid gap-2" style="text-align: center;">
              <label for="cryptodash-notification-orientation" class="form-label badge bg-secondary"><i class="fa fa-sort" ></i> Orientation</label>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="cryptodash-notification-orientation" id="cryptodash-notification-orientation-top" value="TOP" >
                <label class="form-check-label" for="cryptodash-notification-orientation-top">Top</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="cryptodash-notification-orientation" id="cryptodash-notification-orientation-bottom" value="BOTTOM" checked>
                <label class="form-check-label" for="cryptodash-notification-orientation-bottom">Bottom</label>
              </div>
            </div>


            <div class="col-6 d-grid gap-2" style="text-align: center;">
              <label for="cryptodash-notification-location" class="form-label badge bg-secondary"><i class="fa fa-sort fa-rotate-90"></i> Location</label>
            
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="cryptodash-notification-location" id="cryptodash-notification-location-left" value="LEFT" >
                <label class="form-check-label" for="cryptodash-notification-orientation-left">Left</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="cryptodash-notification-location" id="cryptodash-notification-location-right" value="RIGHT" checked>
                <label class="form-check-label" for="cryptodash-notification-location-right">Right</label>
              </div>
            </div>

    
            

          </div>

          
          
    



          <hr>


          <!-- Background Customization -->
          <label for="cryptodashbackground" class="form-label badge bg-secondary"><i class="fa fa-picture-o "></i> Background</label>



          <ul id="cryptodash-bg-type-buttons" class="nav nav-pills nav-justified mb-3" role="tablist" aria-label="Background Type">
            
            <li class="nav-item" role="bgselector">
              <button class="btn btn-outline-dark btn-sm active" id="cryptodash-bg-simple-button" data-bs-toggle="pill" data-bs-target="#cryptodash-bg-simple-tab" type="button" role="tab" aria-controls="cryptodash-bg-single-color-tab" aria-selected="true">Simple</button>
            </li>
            <li class="nav-item" role="bgselector">
              <button class="btn btn-outline-dark btn-sm btn-sm" id="cryptodash-bg-gradient-button" data-bs-toggle="pill" data-bs-target="#cryptodash-bg-gradient-tab" type="button" role="tab" aria-controls="cryptodash-bg-gradient-tab" aria-selected="false">Gradient</button>
            </li>
            <li class="nav-item" role="bgselector">
              <button class="btn btn-outline-dark btn-sm btn-sm" id="cryptodash-bg-abstract-button" data-bs-toggle="pill" data-bs-target="#cryptodash-bg-abstract-tab" type="button" role="tab" aria-controls="cryptodash-bg-abstract-tab" aria-selected="false">Abstract</button>
            </li>          
            
          </ul>
      
    
          <div class="tab-content" id="cryptodash-bg-content">
            <!-- Tracker and Data Content-->
            <div class="tab-pane fade show active" id="cryptodash-bg-simple-tab" role="tabpanel" aria-labelledby="cryptodash-bg-simple-button">
              <div class="d-grid gap-2"> 

                <div class="row">
                  <!-- 
                    <div class="col-4 d-flex justify-content-center">
                    <input class="btn btn-outline-dark btn-sm" type="color">
                  </div>
                  -->
                  
                  <div class="col-6 d-flex justify-content-center">
                    <button class="btn btn-outline-dark btn-sm" id="cryptodash-bg-simple-color">Default Color</button> 
                  </div>
                  <div class="col-6 d-flex justify-content-center">
                    <button class="btn btn-outline-dark btn-sm" id="cryptodash-bg-custom-color">Random Color</button>
                  </div>
                </div>
              
                <!-- <div id="cryptodash-bg-simple-button-group" class="btn-group" role="group" aria-label="Simple Background"> -->
                 
                <!-- </div> -->
              </div>
              

            </div>

            <div class="tab-pane fade" id="cryptodash-bg-gradient-tab" role="tabpanel" aria-labelledby="cryptodash-bg-gradient-button">
              
              <div class="d-grid gap-2"> 
                <!--<div id="cryptodash-bg-gradient-button-group" class="btn-group" role="group" aria-label="Gradient Resolution"> -->
                  <div class="row">
                    <div class="col-6 d-flex justify-content-center">
                      <button class="btn btn-outline-dark btn-sm" id="cryptodash-bg-gradient-hd">HD (1920x1080) </button>
                    </div>
                    <div class="col-6 d-flex justify-content-center">
                      <button class="btn btn-outline-dark btn-sm" id="cryptodash-bg-gradient-4k">4K (3840x2160) </button> <!--(dependent on gradient & abstract only)-->
                    </div>
                  </div>
                <!--</div> -->
  
              </div>

            </div>

            <div class="tab-pane fade" id="cryptodash-bg-abstract-tab" role="tabpanel" aria-labelledby="cryptodash-bg-abstract-button">

              <div class="d-grid gap-2"> 
                <div class="row">
                  <div class="col-6 d-flex justify-content-center">
                    <button class="btn btn-outline-dark btn-sm" id="cryptodash-bg-abstract-hd">HD (1920x1080) </button>
                  </div>
                  <div class="col-6 d-flex justify-content-center">
                    <button class="btn btn-outline-dark btn-sm" id="cryptodash-bg-abstract-4k">4K (3840x2160) </button> <!--(dependent on gradient & abstract only)-->
                  </div>
                </div>
                <!--<div id="cryptodash-bg-abstract-button-group" class="btn-group" role="group" aria-label="Abstract Resolution"> -->
                  
                  

                <!--</div> -->
                
              </div>
            </div>

          </div>

          <div id="cryptodash-download-bg" class="d-grid gap-2 mt-3 mb-3">
            
          </div>

          <div id="cryptodashbackground" class="d-grid gap-2"> 

                     
            
        
          </div>


        </div>

        <!-- Help Content-->
        <div class="tab-pane fade" id="cryptodash-help-tab" role="tabpanel" aria-labelledby="cryptodash-help-tab-button">

          <!-- Configuration Options -->
          <label for="cryptodashConfig" class="form-label badge bg-secondary"><i class="fa fa-cog "></i> Backup Settings</label>
          <div id="cryptodashsettings" class="d-grid gap-2">
            <!--<div id="cryptodashConfig" class="btn-group" role="group" aria-label="Configuration">--> 
              <div class="row">
                <div class="col-4 d-flex justify-content-center">
                  <button type="button" class="btn btn-outline-dark btn-sm" onclick="saveCryptoDashConfig()"><i class="fa fa-save"></i> <br> Save Backup</button>
                </div>
                <div class="col-4 d-flex justify-content-center">
                  <button type="button" class="btn btn-outline-dark btn-sm" data-bs-toggle="modal" data-bs-target="#resetCryptoDashConfigModal"><i class="fa fa-recycle"></i> <br> Reset Dash</button>
                </div>
                <div class="col-4 d-flex justify-content-center">
                  <button type="button" class="btn btn-outline-dark btn-sm" onclick="uploadCryptoDashConfig()"><i class="fa fa-upload"></i> <br> Restore</button>
                </div>
              </div>

            <!--</div> -->
          </div>

          <hr>

          <div id="cryptodash-about" class="d-grid gap-2">
            <a class="btn btn-outline-dark btn-sm" href="https://github.com/mprajescu/cryptodash" target="_blank"><i class="fa fa-github"></i> CryptoDash <span id="cryptodash-date"></span></a>
          </div>

          

          

          

        </div>

      </div>    

    </div>




	  
      
        
      

      
      
      
      
      

      
    </div>
  </div>


  <div class="offcanvas offcanvas-top backdrop-blur" tabindex="-1" id="cryptodash-chart-menu" aria-labelledby="CryptoDashChartMenuLabel">
    <div class="offcanvas-header border-bottom">
      <h5 class="offcanvas-title" id="CryptoDashChartMenuLabel"> About Coin </h5>
      <div id="cryptodash-chart-remove-button"></div>

      <button id="cryptodash-chart-menu-close" type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      
    </div>
    <div class="offcanvas-body">
      
      <div id="blurry">
        
        <div id="cryptodash-chart-status"></div>
        <div id="cryptodash-chart-buttons"></div>
        

        

        <div class="row">

          <div class="col-12" id="cryptodash-30-days-chart">
            <div id="cryptodash-30-days-chart-title"><strong>Last month</strong></div>
            <div id="cryptodash-30-days-chart-status"></div>
            <div id="cryptodash-30-days-chart-content" class="d-flex justify-content-center"></div>
          </div>
          <br><br>
         

          <div class="col-12" id="cryptodash-1-day-chart">
            <div id="cryptodash-1-day-chart-title"><strong>Last day</strong></div>
            <div id="cryptodash-1-day-chart-status"></div>
            <div id="cryptodash-1-day-chart-content" class="d-flex justify-content-center"></div>
          </div>
          <br><br>
          

          <div class="col-12" id="cryptodash-1-hour-chart">
            <div id="cryptodash-1-hour-chart-title"><strong>Last hour</strong></div>
            <div id="cryptodash-1-hour-chart-status"></div>
            <div id="cryptodash-1-hour-chart-content" class="d-flex justify-content-center"></div>
          </div>

        </div>


      </div>

    </div>

  </div>
    
  

  <!-- Reset Config Modal Modal -->
  <div class="modal fade" id="resetCryptoDashConfigModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="resetCryptoDashConfigModalLabel">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content backdrop-blur" id="resetCryptoDashConfigModalContent">
        <div class="modal-header">
          <h5 class="modal-title" id="resetCryptoDashConfigModalLabel"><i class="fa fa-recycle"></i> Reset Crypto Dash</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="resetCryptoDashConfigModalClose"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want reset the Crypto Dash?</p>
          <p>You can also save a backup of the configuration in case you want to restore at a later time.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-dark btn-sm me-auto" onclick="resetCryptoDashConfig()" data-bs-dismiss="modal"><i class="fa fa-recycle"></i> Reset</button>
          <button type="button" class="btn btn-outline-dark btn-sm me-auto" onclick="saveCryptoDashConfig()"><i class="fa fa-save"></i> Save Backup</button>           
          <button type="button" class="btn btn-outline-dark btn-sm" data-bs-dismiss="modal"><i class="fa fa-close"></i> Cancel</button>
          
           
          
          
          
        </div>
      </div>
    </div>
  </div>

  <!-- Upload Config Modal-->
  <div class="modal fade " id="uploadCryptoDashConfigModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="uploadCryptoDashConfigModalLabel">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content backdrop-blur" id="uploadCryptoDashConfigModalContent">
        <div class="modal-header">
          <h5 class="modal-title" id="uploadCryptoDashConfigModalLabel"><i class="fa fa-upload"></i> Restore Crypto Dash</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="uploadCryptoDashConfigModalClose"></button>
        </div>

        <form id="uploadCryptoDashConfigForm">

          <div class="modal-body">

            <p>Select your Crypto Dash backup file then click restore.</p>

            <label for="uploadCryptoDashConfigInput" class="form-label">Crypto Dash Backup File</label>
            <input class="form-control bg-light" type="file" id="uploadCryptoDashConfigInput" accept=".cdbackup" >
          </div>


          <div class="modal-footer">
            
            
            <button type="submit" class="btn btn-outline-dark btn-sm me-auto"><i class="fa fa-upload"></i> Restore</button>
            <button type="button" class="btn btn-outline-dark btn-sm" data-bs-dismiss="modal"><i class="fa fa-close"></i> Cancel</button>
          </div>

        </form>
        

      </div>
    </div>
  </div>

  
    
  



  <!-- Modal -->
<div class="modal fade " id="manageCryptoDashCoinsModal" data-bs-backdrop="static" data-bs-keyboard="true" tabindex="-1" aria-labelledby="manageCryptoDashCoinsModalLabel">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content backdrop-blur" id="manageCryptoDashCoinsModalContent">
      <div class="modal-header">
        <h5 class="modal-title" id="manageCryptoDashCoinsModalLabel"><i class="fa fa-th-large "></i> Trackers</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="manageCryptoDashCoinsModalClose"></button>
      </div>
      <div class="modal-body">
        
      <p> Search and add coins to be tracked. Maximum allowed is 32 trackers. </p>
      
        <select id="CryptoDashCoinsSelector" multiple placeholder="">
            <!--
            <option value="BTC">Bitcoin</option>
            <option value="ETH">Etherium</option>
            <option value="XRP">Ripple</option>
            <option value="CAKE">PancakeSwap</option>
            <option value="DOGE">Dodgecoin</option>
            <option value="KAT">Kambria</option>
            <option value="SHIB">Shiba Inu</option>
            <option value="XMR">Monero</option>
            -->
          
        </select>
        
		
		
		
      </div>
    
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade " id="manageCryptoDashDataSourceModal" data-bs-backdrop="static" data-bs-keyboard="true" tabindex="-1" aria-labelledby="manageCryptoDashDataSourceModalLabel">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content backdrop-blur" id="manageCryptoDashDataSourceModalContent">
      <div class="modal-header">
        <h5 class="modal-title" id="manageCryptoDashDataSourceModalLabel"><i class="fa fa-database "></i> Data Source</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="manageCryptoDashDataSourceModalClose"></button>
      </div>
      <div class="modal-body">
              
     
        <p>Please take into consideration that with any data refresh it will count towards your API Requests.</p>
        <p>API requests are as follows:</p>
        <ul>
          <li>When you are first loading the page, it generates one request to pull the list of coins dynamically</li>
          <li>When clicking on a tracker image, it will generate 3 requests to pull 3 types of history charts</li>
          <li>When it refreshes the data to pull the information for trackers, it will generate only one request for all tracked coins</li>
          <li>When you check for your rates, you will do one request</li>
          <li>Auto refresh pulls only once, every X amount of time. It's just like a manual refresh, meaning you only multiply by the amount of time it runs.</li>

        </ul>
        <p>You can calculate and see your API calls in realtime on Crypto Compare or use the Data Source Rate Limits option from the Crypto Dash settings.</p>
      



        <hr>
        <!-- datasource Selector -->
        <a href="https://cryptocompare.com" target="_blank"><label for="cryptodash-datasource-cryptocompare" class="form-label badge bg-secondary"><i class="fa fa-globe "></i> Crypto Compare (link)</label></a>
        
        <div id="cryptodash-datasource-cryptocompare" class="gap-2 cryptodash-datasources justify-content-center"> 
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="cryptodash-datasource" id="cryptodash-datasource-cryptocompare-free" value="CryptoCompareFree" checked>
            <label class="form-check-label" for="cryptodash-datasource-cryptocompare-free">Free (No API Key required) </label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="cryptodash-datasource" id="cryptodash-datasource-cryptocompare-api" value="CryptoCompareAPI">
            <label class="form-check-label" for="cryptodash-datasource-cryptocompare-api">Use API Key</label>
          </div>

          <div id="" class="d-grid gap-2">
            <a href="https://min-api.cryptocompare.com/pricing" target="_blank" class="btn btn-outline-dark btn-sm ">Get a Crypto Compare API Key</a>
          </div>


        </div>  
        

        <!-- To implement these API data sources -->
        <hr>

        <a href="https://livecoinwatch.com" target="_blank"><label for="cryptodash-datasource-livecoinwatch" class="form-label badge bg-secondary"><i class="fa fa-globe "></i> Live Coin Watch (link)</label></a>
        
        <div id="cryptodash-datasource-livecoinwatch" class="gap-2 cryptodash-datasources justify-content-center"> 
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="cryptodash-datasource" id="cryptodash-datasource-livecoinwatch-api" value="LiveCoinWatchAPI">
            <label class="form-check-label" for="cryptodash-datasource-livecoinwatch-api">Use API Key</label>
          </div>
        </div> 

        <div id="" class="d-grid gap-2">
          <a href="https://www.livecoinwatch.com/tools/api#try" target="_blank" class="btn btn-outline-dark btn-sm">Get a Live Coin Watch API Key</a>
        </div>
        

        <hr>

        <a href="https://coinmarketcap.com" target="_blank"><label for="cryptodash-datasource-coinmarketcap" class="form-label badge bg-secondary"><i class="fa fa-globe "></i> Coin Market Cap (link)</label></a>
        
        <div id="cryptodash-datasource-coinmarketcap" class="gap-2 cryptodash-datasources justify-content-center"> 
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="cryptodash-datasource" id="cryptodash-datasource-coinmarketcap-api" value="CoinMarketCapAPI">
            <label class="form-check-label" for="cryptodash-datasource-coinmarketcap-api">Use API Key</label>
          </div>
        </div> 

        <p>
          Please note the charts do not work with this data source because Coin Market Cap doesn't offer history requests on their free API tier. 
          <br> 
          If you would like to implement this functionality, reach out on the project <a class="" href="https://github.com/mprajescu/cryptodash" target="_blank">GitHub page</a> and donate for a paid API key. 
        
        </p>

        <div id="" class="d-grid gap-2">
          <a href="https://coinmarketcap.com/api/pricing/" target="_blank" class="btn btn-outline-dark btn-sm">Get a Coin Market Cap API Key</a>
        </div>

        

        
        <!-- To implement these API data sources -->
        
        
        
		
      </div>
      <div class="modal-footer">
        
        <div class="input-group input-group-sm">
          <span class="input-group-text"><i class="fa fa-key"></i></span>
          <input type="text" id="cryptodash-apikey" class="form-control" placeholder="API Key" aria-label="API Key" aria-describedby="cryptodash-apikey" disabled>
          <button class="btn btn-sm btn-outline-dark" type="button" id="cryptodash-apikey-button" onclick="setCryptoDashDataSourceAPIKey()" disabled>Update</button>
        </div>
        
      </div>
    
    </div>
  </div>
</div>
  







</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.0.0/dist/js/tom-select.complete.min.js"></script>

<script type="text/javascript">

// Declaring variables outside of function 

//CryptoDash Currency
var CryptoDashCurrency = window.localStorage.getItem('CryptoDashCurrency');

// CryptoDash Data Source
var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");

// CryptoDash Data Source API Key
var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");



// CryptoDash loader
const CryptoDashLoader = document.querySelector('#cryptodash-loader');
const CryptoDashContent = document.getElementById('cryptodash-content');

window.addEventListener('load', (event) => {

  const fadeEffect = setInterval(() => {
    // if we don't set opacity 1 in CSS, then it will be equaled to "" -- that's why we check it, and if so, set opacity to 1
    if (!CryptoDashLoader.style.opacity) {
      CryptoDashLoader.style.opacity = 1;
      CryptoDashContent.style.opacity = 0;
    }

    if (CryptoDashLoader.style.opacity > 0) {
      CryptoDashLoader.style.opacity -= 0.1;
      CryptoDashContent.style.opacity = 1;    
    } else {
      clearInterval(fadeEffect);
    }

  }, 200);

});


// Indexed DB Checks
window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || 
window.msIndexedDB;
 
window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || 
window.msIDBTransaction;
window.IDBKeyRange = window.IDBKeyRange || 
window.webkitIDBKeyRange || window.msIDBKeyRange
 
//if (!window.indexedDB) {

if (!window.indexedDB) {

  /*
  var toastElList = [].slice.call(document.querySelectorAll('.toast'))
  var toastList = toastElList.map(function(toastEl) {
  // Creates an array of toasts (it only initializes them)
    return new bootstrap.Toast(toastEl) // No need for options; use the default options
  });
  toastList.forEach(toast => toast.show()); // This show them
  //CryptoDashLoader.style.display = "block";
  //CryptoDashContent.style.display = "none";
  //alert.close()

  document.getElementById("liveToast").classList.add("show");
  document.getElementById("liveToast").classList.remove("hide");

  */

  showCryptoDashNotification( `
  
  <div class="bordered">
    <span>Your browser does not support a stable version of IndexedDB. <br> You can use one of these browsers below.</span>
      <div class="mt-2 pt-2">
        <div class="btn-group" role="group" aria-label="Browsers">
          <a class="btn btn-outline-dark btn-sm" href="https://www.microsoft.com/en-us/edge">Microsoft Edge</a>
          <a class="btn btn-outline-dark btn-sm" href="https://www.google.com/intl/en_us/chrome/">Google Chrome</a>
          <a class="btn btn-outline-dark btn-sm" href="https://www.mozilla.org/en-GB/firefox/new/">Mozilla Firefox</a>
        </div>
      </div>
  </div>
  
  `
    , "-1");

  

  // window.alert("Your browser doesn't support a stable version of IndexedDB.")
}



// Date in Crypto Dash menu 
const CryptoDashCurrentDate =  new Date();
CryptoDashCurrentDateYear = CryptoDashCurrentDate.getFullYear();
CryptoDashCurrentDateMonth = CryptoDashCurrentDate.getMonth() + 1;
CryptoDashCurrentDateDay = CryptoDashCurrentDate.getDate();
CryptoDashCurrentDateHour = CryptoDashCurrentDate.getHours();
CryptoDashCurrentDateMinute = CryptoDashCurrentDate.getMinutes();
CryptoDashCurrentDateDaySecond = CryptoDashCurrentDate.getSeconds();

document.getElementById("cryptodash-date").innerHTML = CryptoDashCurrentDateDay + "/" + CryptoDashCurrentDateMonth + "/" + CryptoDashCurrentDateYear;

/* CLOCK */
var CryptoDashClock = setInterval(function() {
  CryptoDashClockTimer();
}, 1000);

function CryptoDashClockTimer() {
  var d = new Date();
  document.getElementById("cryptodash-clock").innerHTML = " <i class=\"fa fa-clock-o\"></i> " + d.toLocaleTimeString();
};


// generate file to be downloaded 
function CryptoDashDownloader(content, fileName, contentType) {
  const a = document.createElement("a");
  const file = new Blob([content], { type: contentType });
  a.href = URL.createObjectURL(file);
  a.download = fileName;
  a.click();
}

// add Crypto Dash configuration Date to Local Storage
function setCryptoDashConfigDate() {
  const CryptoDashConfigDate = CryptoDashCurrentDateDay + "-" + CryptoDashCurrentDateMonth + "-" + CryptoDashCurrentDateYear;
  window.localStorage.setItem('CryptoDashConfigDate', CryptoDashConfigDate);
}

// reset the Crypto Dash configuration and refresh page
function resetCryptoDashConfig() {
  window.localStorage.clear();
  location.reload();
}

// save the Crypto Dash configuration
function saveCryptoDashConfig(){
  const CryptoDashConfig = JSON.stringify(window.localStorage);
  const CryptoDashConfigFileName = "CryptoDash" + "-" + CryptoDashCurrentDateDay + "-" + CryptoDashCurrentDateMonth + "-" + CryptoDashCurrentDateYear +".cdbackup";
  CryptoDashDownloader(CryptoDashConfig, CryptoDashConfigFileName, "text/plain");
  
}

//upload config
function uploadCryptoDashConfig(){

  // define modal
  var uploadCryptoDashConfigModal = new bootstrap.Modal(document.getElementById('uploadCryptoDashConfigModal'))

  // show modal
  uploadCryptoDashConfigModal.show(uploadCryptoDashConfigModal);

  let CryptoDashConfigForm = document.querySelector("#uploadCryptoDashConfigForm");
  let CryptoDashConfigFile = document.querySelector("#uploadCryptoDashConfigInput");

  // listen to the submit button to trigger the upload handler
  CryptoDashConfigForm.addEventListener('submit', CryptoDashUploadHandler);

  function CryptoDashConfigProcessor (event) {
    let CryptoDashConfig = JSON.parse(event.target.result);
    
    window.localStorage.clear();
    Object.keys(CryptoDashConfig).forEach(function(value){

      window.localStorage.setItem(value, CryptoDashConfig[value]);

    });
    
    location.reload();

  }
  
  function CryptoDashUploadHandler (event) {

    // Stop the form from reloading the page
    event.preventDefault();

    // If there's no file, do nothing
    if (!CryptoDashConfigFile.value.length) return;

    // Create a new FileReader() object
    let CryptoDashFileReader = new FileReader();

    // Setup the callback event to run when the file is read
    CryptoDashFileReader.onload = CryptoDashConfigProcessor;

    // Read the file
    CryptoDashFileReader.readAsText(CryptoDashConfigFile.files[0]);

  }

}

function pullCryptoDashCoinList() {

  var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
  var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

  showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Getting list of coins`, 3000);

  if (CryptoDashDataSource == null) {
    //showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Data Source Error</strong> <br>` + `Cannot read Data Source`, -1, true);
    window.localStorage.setItem("CryptoDashDataSource", "CryptoCompareFree");

  }

  function checkCryptoDashDataSourceAPIKey() {

    if (CryptoDashDataSourceAPIKey == null) {
    
      throw new Error('Data Source API Key not found in Local Storage');
      
    }

  }
  
  if (CryptoDashDataSource === "CryptoCompareFree" ) {
    
    try {
     
      const myRequest = 'https://min-api.cryptocompare.com/data/all/coinlist';

      fetch(myRequest)
      .then(response => {
          const data = response.json();
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return data;
      })
      .then(data => {
          /* process your data further */

          //var CryptoDashCoinListData = JSON.stringify(data);

          if(data['Response'] === "Error"){

            console.error("Crypto Compare API Error: " + data['Message']);

            showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
            
            console.error("Current Calls");
            console.table(data['RateLimit']['calls_made']);
            console.error("Free Max Calls");
            console.table(data['RateLimit']['max_calls']);
        
            var cryptodashcallsmade = helperCryptoDashObjectToHTMLTable(data['RateLimit']['calls_made']);
            var cryptodashmaxcalls = helperCryptoDashObjectToHTMLTable(data['RateLimit']['max_calls']);

            showCryptoDashNotification(`<i class="fa fa-info-circle"></i> <strong>Current API Calls</strong> <br>` + cryptodashcallsmade,  -1, true);
            showCryptoDashNotification(`<i class="fa fa-info-circle"></i> <strong>Free Maximum API Calls</strong>` + cryptodashmaxcalls,  -1, true);

          } else {

            CryptoDashCoinsSelector.clear();
            CryptoDashCoinsSelector.clearOptions();
            CryptoDashCoinsSelector.refreshItems();

            for (var property in data['Data']) {
              //console.log(`${property}: ${data['Data'][property]['FullName']}`);

              if(data['Data'][property]['PlatformType'] === "blockchain" || data['Data'][property]['PlatformType'] === "token" ) {
                CryptoDashCoinsSelector.addOption({
                  value: data['Data'][property]['Symbol'], text: data['Data'][property]['CoinName'],
                  //value: data['Data'][property]['Symbol'], text: data['Data'][property]['Name'],
                  //value: data['Data'][property]['Symbol'], text: data['Data'][property]['FullName'],
                });

              }

            };

            var CryptoDashLayout = JSON.parse(window.localStorage.getItem('CryptoDashLayout'));

            if(CryptoDashLayout && CryptoDashLayout !== "[]") {
                
              for (var i = 0; i < CryptoDashLayout.length; i++) {
                var itemId = CryptoDashLayout[i];
                CryptoDashCoinsSelector.addItem(itemId);
              }
                  
              CryptoDashCoinsSelector.refreshItems();
              CryptoDashGrid.layout(true);

              manualCryptoDashFetchTrackerData();

              updateCryptoDashTrackerFontSize();

              updateCryptoDashCoinSelectorCloseButton();
            }
            
            showCryptoDashNotification('<i class="fa fa-info-circle"></i> List of coins successfully retreived', 3000);

          }
          
      })
      .catch(e => {
        console.error(e);
        showCryptoDashNotification(e, 3000);
      }); 
        
    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, -1, true);
    }

    

  }

  if (CryptoDashDataSource === "CryptoCompareAPI" ) {
    
    try {
      checkCryptoDashDataSourceAPIKey();

      try {
     
        var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

        const myRequest = 'https://min-api.cryptocompare.com/data/all/coinlist?api_key=' + CryptoDashDataSourceAPIKey;

        fetch(myRequest)
        .then(response => {
            const data = response.json();
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return data;
        })
        .then(data => {
            /* process your data further */

            //var CryptoDashCoinListData = JSON.stringify(data);

            if(data['Response'] === "Error"){

              console.error("Crypto Compare API Error: " + data['Message']);

              showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
              
              console.error("Current Calls");
              console.table(data['RateLimit']['calls_made']);
              console.error("Free Max Calls");
              console.table(data['RateLimit']['max_calls']);
          
              var cryptodashcallsmade = helperCryptoDashObjectToHTMLTable(data['RateLimit']['calls_made']);
              var cryptodashmaxcalls = helperCryptoDashObjectToHTMLTable(data['RateLimit']['max_calls']);

              showCryptoDashNotification(`<i class="fa fa-info-circle"></i> <strong>Current API Calls</strong> <br>` + cryptodashcallsmade,  -1, true);
              showCryptoDashNotification(`<i class="fa fa-info-circle"></i> <strong>Free Maximum API Calls</strong>` + cryptodashmaxcalls,  -1, true);

            } else {

              CryptoDashCoinsSelector.clear();
              CryptoDashCoinsSelector.clearOptions();
              CryptoDashCoinsSelector.refreshItems();

              for (var property in data['Data']) {
                //console.log(`${property}: ${data['Data'][property]['FullName']}`);

                if(data['Data'][property]['PlatformType'] === "blockchain" || data['Data'][property]['PlatformType'] === "token" ) {
                  CryptoDashCoinsSelector.addOption({
                    value: data['Data'][property]['Symbol'], text: data['Data'][property]['CoinName'],
                    //value: data['Data'][property]['Symbol'], text: data['Data'][property]['Name'],
                    //value: data['Data'][property]['Symbol'], text: data['Data'][property]['FullName'],
                  });

                }
                //CryptoDashCoinsSelector.refreshItems();
                
              };

              var CryptoDashLayout = JSON.parse(window.localStorage.getItem('CryptoDashLayout'));

              if(CryptoDashLayout && CryptoDashLayout !== "[]") {
                  
                for (var i = 0; i < CryptoDashLayout.length; i++) {
                  var itemId = CryptoDashLayout[i];
                  CryptoDashCoinsSelector.addItem(itemId);
                }
                    
                CryptoDashCoinsSelector.refreshItems();
                CryptoDashGrid.layout(true);

                manualCryptoDashFetchTrackerData();

                updateCryptoDashTrackerFontSize();

                updateCryptoDashCoinSelectorCloseButton();
              }
              
              showCryptoDashNotification('<i class="fa fa-info-circle"></i> List of coins successfully retreived', 3000);

            }

            
            
        })
        .catch(e => {
          console.error(e);
          showCryptoDashNotification(e, 3000);
        });
           
          
      } catch(e) {
        console.error(e);
        showCryptoDashNotification(e, -1, true);
      }
    
    } catch(e) {
      console.error(e);
      showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + e, -1, true);
    }
    

  }

  if (CryptoDashDataSource === "LiveCoinWatchAPI" ) {
    
    showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Live Coin Watch API Error</strong> <br>` + `Functionality not yet implemented`, -1, true);
    

  }

  if (CryptoDashDataSource === "CoinMarketCapAPI" ) {
    
    showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Coin Market Cap API Error</strong> <br>` + `Functionality not yet implemented`, -1, true);
    

  }



  

}

function updateCryptoDashCoinSelectorCloseButton() {
  var CryptoDashCoinSelectorCloseButton = document.querySelector(".clear-button");
  CryptoDashCoinSelectorCloseButton.innerHTML = '<i class="fa fa-trash"></i>';

  document.querySelectorAll("a.remove").forEach((element) => {
    element.innerHTML = '<i class="fa fa-trash"></i>';
  });
  
}

function updateCryptoDashTrackerFontSize() {
  document.querySelectorAll(".cryptodash-tracker").forEach((element) => {
    window.fitText( element, 1.35 );
  });
}

// Selecter from the tracker in the settings menu
var CryptoDashCoinsSelector = new TomSelect("#CryptoDashCoinsSelector",{
  //plugins: ['remove_button'],
  plugins: {
		'remove_button':{
			title:'Remove this tracker',
		},
    'clear_button':{
			'title':'Remove all selected trackers',
		},
	},
  maxItems: 32,
  maxOptions: 2500,
  create: false,
  // Find dynamic list of all coins based on all coin list from data source
 /* options: [
    { value: "BTC", text: "Bitcoin" },
    { value: "ETH", text: "Etherium" },
    { value: "XRP", text: "Ripple" },
    { value: "CAKE", text: "PancakeSwap" },
    { value: "DOGE", text: "Dodgecoin" },
    { value: "KAT", text: "Kambria" },
    { value: "SHIB", text: "Shiba Inu" },
    { value: "XMR", text: "Monero" },
  ], */
  searchField: ['text','value'],
  sortField: {
    field: 'text',
    direction: 'asc'
  },
  onItemAdd:function(value, item){
    this.setTextboxValue('');
    this.refreshOptions();
    createCryptoDashTracker(value);
    updateCryptoDashTrackerFontSize();
    // console.log("changed Crypto Dash coin selection and added the " + value + " Tracker");
    //manualCryptoDashFetchTrackerData();

    showCryptoDashNotification('<i class="fa fa-info-circle "></i>' + " Tracker "+ value + " added successfully", 3000);
    updateCryptoDashCoinSelectorCloseButton() ;
    

  },
  onItemRemove:function(CryptoDashTrackerID){
    this.refreshOptions();
    removeCryptoDashTracker(CryptoDashTrackerID);
    showCryptoDashNotification('<i class="fa fa-info-circle "></i>' + " Tracker "+ CryptoDashTrackerID + " removed successfully", 3000);
    //console.log("changed Crypto Dash coin selection and removed the " + value + " Tracker");
  },
  render:{
    option:function(data,escape){
    //console.log(data);
      return '<div class="d-flex"><span>' + escape(data.text) + ' (' + escape(data.value) + ')</span> </div>';
    },
    item:function(data,escape){
      return '<div>' + escape(data.text) + ' (' + escape(data.value) + ') </div>';
    }
  }
});


// GRID

var CryptoDashGrid = new Muuri('.cryptodash-grid', {
  
  dragEnabled: true,
  layoutOnInit: false

}).on('move', function () {
  saveCryptoDashLayout(CryptoDashGrid);
});

var CryptoDashLayout = window.localStorage.getItem('CryptoDashLayout');
var CryptoDashTrackerWidth = window.localStorage.getItem('CryptoDashTrackerWidth');
var CryptoDashTrackerHeight = window.localStorage.getItem('CryptoDashTrackerHeight');

if (CryptoDashLayout) {
  loadCryptoDashLayout(CryptoDashGrid, CryptoDashLayout);

  if(CryptoDashLayout === "[]") {
    var CryptoDashRefreshButton = document.getElementById("cryptodash-refresh-button");
    var HideCryptoDashRefreshButton = document.createAttribute("hidden");
    
    CryptoDashRefreshButton.setAttributeNode(HideCryptoDashRefreshButton);

  } else {
    document.getElementById("cryptodash-refresh-button").removeAttribute("hidden");
    
  }

} else {
  CryptoDashGrid.layout(true);
}

if (CryptoDashTrackerWidth && CryptoDashTrackerHeight) {
  document.querySelectorAll(".cryptodash-tracker").forEach((element) => {
    element.style.width = CryptoDashTrackerWidth;
    element.style.height = CryptoDashTrackerHeight;
  });

  var itemSizeRanger = document.getElementById("itemSizeRanger");

  itemSizeRanger.value = CryptoDashTrackerWidth.substring(0, CryptoDashTrackerWidth.length - 2);
  itemSizeRanger.title = itemSizeRanger.value + 'px';
  document.getElementById("gridsizeSpan").innerHTML = itemSizeRanger.title; 
  CryptoDashGrid.refreshItems();
  CryptoDashGrid.layout(true);

} else {

  var itemSizeRanger = document.getElementById("itemSizeRanger");
  itemSizeRanger.value = 420;
  itemSizeRanger.title = itemSizeRanger.value + 'px';
  document.getElementById("gridsizeSpan").innerHTML = itemSizeRanger.title;

}

function serializeCryptoDashLayout(CryptoDashGrid) {
  var itemIds = CryptoDashGrid.getItems().map(function (item) {
    //console.log(item);
    return item.getElement().getAttribute('crypto-dash-id');
  });
  //console.log(JSON.stringify(itemIds));
  return JSON.stringify(itemIds);
}

function saveCryptoDashLayout(CryptoDashGrid) {
  var CryptoDashLayout = serializeCryptoDashLayout(CryptoDashGrid);
  window.localStorage.setItem('CryptoDashLayout', CryptoDashLayout);
  setCryptoDashConfigDate();
}

function loadCryptoDashLayout(CryptoDashGrid, serializedCryptoDashLayout){

  var CryptoDashLayout = JSON.parse(window.localStorage.getItem('CryptoDashLayout'));
          
  for (var i = 0; i < CryptoDashLayout.length; i++) {
    var itemId = CryptoDashLayout[i];
    CryptoDashCoinsSelector.addItem(itemId);
  }
          
  CryptoDashGrid.layout(true);
  
}

// Notification function
function showCryptoDashNotification(CryptoDashNotificationText, CryptoDashNotificationDuration, CryptoDashNotificationClose) {

  var settings = localStorage.getItem("CryptoDashLightSwitch");
  var settingsFrosted = window.localStorage.getItem("CryptoDashFrostedThemeSwitch");
  var CryptoDashNotificationOrientation = window.localStorage.getItem("CryptoDashNotificationOrientation");
  var CryptoDashNotificationLocation = window.localStorage.getItem("CryptoDashNotificationLocation");

  if (settingsFrosted == null) {
    window.localStorage.setItem("CryptoDashFrostedThemeSwitch", "Frosted");
    var frostedStatus = "tracker-backdrop-blur ";
  }
  
  if (settingsFrosted == "Frosted") {
    var frostedStatus = "tracker-backdrop-blur ";
  }

  if (settingsFrosted == "Defrosted") {

    if (settings == null) {
      var frostedStatus = "bg-light ";
    }
    
    if (settings == "dark") {
      var frostedStatus = "bg-dark ";
    }
  
    if (settings == "light") {
      var frostedStatus = "bg-light ";
    }
    
  }
  

  if (settings == null) {
    var color = "text-dark";
  }
  
  if (settings == "dark") {
    var color = "text-light";
  }

  if (settings == "light") {
    var color = "text-dark";
  }

  if (!CryptoDashNotificationClose) {
    var CryptoDashNotificationClose = false;
  }



  Toastify({
    text: ` <div class="bordered" style="display: inline-block;"><div >` + CryptoDashNotificationText + `</div></div>`,
    duration: CryptoDashNotificationDuration,
    className: frostedStatus + color,
    newWindow: true,
    close: CryptoDashNotificationClose,
    gravity: CryptoDashNotificationOrientation, // `top` or `bottom`
    position: CryptoDashNotificationLocation, // `left`, `center` or `right`
    stopOnFocus: true, // Prevents dismissing of toast on hover
    escapeMarkup: false,
    
    style: {
      
      //padding: "0px !important",
      
    },

    onClick: function(){} // Callback after click
  }).showToast();

}


// dark and light mode
(function () {
  let CryptoDashLightSwitch = document.getElementById("CryptoDashLightSwitch");
  if (!CryptoDashLightSwitch) {
    return;
  }
  
  /**
   * @function darkmode
   * @summary: changes the theme to 'dark mode' and save settings to local stroage.
   * Basically, replaces/toggles every CSS class that has '-light' class with '-dark'
   */
  function darkMode() {
    document.querySelectorAll(".bg-light").forEach((element) => {
      element.className = element.className.replace(/-light/g, "-dark");
    });

    //document.body.classList.add("bg-dark");
    document.getElementById("cryptodash-settings-menu-close").classList.add("bg-light");
    document.getElementById("cryptodash-settings-menu-close").classList.remove("bg-dark");
    document.getElementById("cryptodash-chart-menu-close").classList.add("bg-light");
    document.getElementById("cryptodash-chart-menu-close").classList.remove("bg-dark");
    


    document.getElementById("cryptodash-settings-button").classList.add("btn-dark");
    document.getElementById("cryptodash-settings-button").classList.remove("btn-light");
    document.getElementById("cryptodash-refresh-button").classList.add("btn-dark");
    document.getElementById("cryptodash-refresh-button").classList.remove("btn-light");
    document.getElementById("cryptodash-clock").classList.add("btn-dark");
    document.getElementById("cryptodash-clock").classList.remove("btn-light");

    //reset config modal close button & modal
    document.getElementById("resetCryptoDashConfigModalClose").classList.add("bg-light");
    document.getElementById("resetCryptoDashConfigModalClose").classList.remove("bg-dark");
    //document.getElementById("resetCryptoDashConfigModalContent").classList.add("bg-dark");
    //document.getElementById("resetCryptoDashConfigModalContent").classList.remove("bg-light");
	  //document.getElementById("manageCryptoDashCoinsModalContent").classList.add("bg-dark");
    //document.getElementById("manageCryptoDashCoinsModalContent").classList.remove("bg-light");
	  document.getElementById("manageCryptoDashCoinsModalClose").classList.add("bg-light");
    document.getElementById("manageCryptoDashCoinsModalClose").classList.remove("bg-dark");
    document.getElementById("manageCryptoDashDataSourceModalClose").classList.add("bg-light");
    document.getElementById("manageCryptoDashDataSourceModalClose").classList.remove("bg-dark");
    
    //document.getElementById("uploadCryptoDashConfigModalContent").classList.add("bg-dark");
    //document.getElementById("uploadCryptoDashConfigModalContent").classList.remove("bg-light");
	  document.getElementById("uploadCryptoDashConfigModalClose").classList.add("bg-light");
    document.getElementById("uploadCryptoDashConfigModalClose").classList.remove("bg-dark");
    document.getElementById("uploadCryptoDashConfigInput").classList.add("text-light");
    document.getElementById("uploadCryptoDashConfigInput").classList.remove("text-dark");
    
    // update the select drop down
    // -  document.querySelector('.ts-control').classList.add("bg-dark");
    //document.querySelector('.ts-dropdown').classList.add("bg-dark");
    document.getElementById("CryptoDashCoinsSelector-ts-control").classList.add("text-white");
    //document.querySelectorAll(".option:not(.active)").forEach((element) => {
    //  element.classList.add("text-black-50");
    //});

    //document.querySelector('body').style.setProperty('text-shadow', "0px 0px 2px #000");
      
    document.documentElement.style.setProperty('--frosted-bg-color', "rgba(0, 0, 0, 0.25)");
    document.documentElement.style.setProperty('--frosted-tracker-bg-color', "rgba(0, 0, 0, 0.25)");
    
    document.getElementById("cryptodash-apikey").style.setProperty('border', '1px solid #f8f9fa');
    document.getElementById("cryptodash-apikey").classList.remove("text-dark");
    document.getElementById("cryptodash-apikey").classList.add("text-light");
    document.querySelector(".input-group-text").style.setProperty('border', '1px solid #f8f9fa');
    document.querySelector(".input-group-text").classList.remove("text-dark");
    document.querySelector(".input-group-text").classList.add("text-light");

    /*
    document.querySelector(".accordion-button").classList.remove("text-dark");
    document.querySelector(".accordion-button").classList.add("text-light");
    document.querySelector(".accordion-item").classList.remove("text-dark");
    document.querySelector(".accordion-item").classList.add("text-light");
    */

    document.querySelectorAll(".accordion-button").forEach((element) => {
      //element.classList.remove("backdrop-blur");
      element.classList.add("text-light");
      element.classList.remove("text-dark");
      

    });

    document.querySelectorAll(".accordion-item").forEach((element) => {
      //element.classList.remove("backdrop-blur");
      element.classList.add("text-light");
      element.classList.remove("text-dark");
      

    });



    // .select backdrop-blur class
    document.querySelectorAll(".ts-dropdown").forEach((element) => {
      //element.classList.remove("backdrop-blur");
      element.classList.add("text-light");
      element.classList.remove("text-dark");
      

    });

    // .select backdrop-blur class
    document.querySelectorAll(".option").forEach((element) => {
      //element.classList.remove("backdrop-blur");
      if(element.classList.contains("active")){
        //element.classList.add("text-dark");
        //element.classList.remove("text-light");
      } else {
      element.classList.remove("text-light");
      element.classList.remove("text-dark");
      }

    });

    document.querySelectorAll(".btn-outline-dark").forEach((element) => {
      element.className = element.className.replace(/-dark/g, "-light");
    });

    document.querySelectorAll(".box-close-item").forEach((element) => {
      element.classList.add("btn-light");
      element.classList.remove("btn-dark");
    });

    if (document.body.classList.contains("text-dark")) {
      document.body.classList.replace("text-dark", "text-light");
    } else {
      document.body.classList.add("text-light");
    }
    
    

    // set light switch input to true
    if (! CryptoDashLightSwitch.checked) {
      CryptoDashLightSwitch.checked = true;
    }
    
    showCryptoDashNotification(`<i class="fa fa-moon-o"></i> Dark theme set`, 3000);

    localStorage.setItem("CryptoDashLightSwitch", "dark");
    setCryptoDashConfigDate();

  }

  /**
   * @function lightmode
   * @summary: changes the theme to 'light mode' and save settings to local stroage.
   */
  function lightMode() {
    document.querySelectorAll(".bg-dark").forEach((element) => {
      element.className = element.className.replace(/-dark/g, "-light");
    });

    //document.body.classList.add("bg-light");
    document.getElementById("cryptodash-settings-button").classList.add("btn-light");
    document.getElementById("cryptodash-settings-button").classList.remove("btn-dark");
    document.getElementById("cryptodash-refresh-button").classList.add("btn-light");
    document.getElementById("cryptodash-refresh-button").classList.remove("btn-dark");
    document.getElementById("cryptodash-clock").classList.add("btn-light");
    document.getElementById("cryptodash-clock").classList.remove("btn-dark");
    document.getElementById("uploadCryptoDashConfigInput").classList.add("text-dark");
    document.getElementById("uploadCryptoDashConfigInput").classList.remove("text-light");

    // update the select drop down
    // - document.querySelector('.ts-control').classList.add("bg-light");
    //document.querySelector('.ts-dropdown').classList.add("bg-light");
    document.getElementById("CryptoDashCoinsSelector-ts-control").classList.add("text-dark");
    //document.querySelectorAll(".option:not(.active)").forEach((element) => {
    //  element.classList.add("text-dark");
    //});

    //document.querySelector('body').style.setProperty('text-shadow', "0px 0px 1px #000");

    document.documentElement.style.setProperty('--frosted-bg-color', "rgba(255, 255, 255, 0.50)");
    document.documentElement.style.setProperty('--frosted-tracker-bg-color', "rgba(255, 255, 255, 0.25)");

    document.getElementById("cryptodash-apikey").style.setProperty('border', '1px solid #212529');
    document.getElementById("cryptodash-apikey").classList.remove("text-light");
    document.getElementById("cryptodash-apikey").classList.add("text-dark");
    document.querySelector(".input-group-text").style.setProperty('border', '1px solid #212529');
    document.querySelector(".input-group-text").classList.remove("text-light");
    document.querySelector(".input-group-text").classList.add("text-dark");

      /*
    document.querySelector(".accordion-button").classList.remove("text-light");
    document.querySelector(".accordion-button").classList.add("text-dark");
    document.querySelector(".accordion-item").classList.remove("text-light");
    document.querySelector(".accordion-item").classList.add("text-dark");
      */

      document.querySelectorAll(".accordion-button").forEach((element) => {
        //element.classList.remove("backdrop-blur");
        element.classList.add("text-dark");
        element.classList.remove("text-light");
        
  
      });
  
      document.querySelectorAll(".accordion-item").forEach((element) => {
        //element.classList.remove("backdrop-blur");
        element.classList.add("text-dark");
        element.classList.remove("text-light");
        
  
      });


    document.querySelectorAll(".box-close-item").forEach((element) => {
      element.classList.add("btn-dark");
      element.classList.remove("btn-light");
    });

    document.querySelectorAll(".btn-outline-light").forEach((element) => {
      element.className = element.className.replace(/-light/g, "-dark");
    });
    
    // .select backdrop-blur class
    document.querySelectorAll(".ts-dropdown").forEach((element) => {
      //element.classList.remove("backdrop-blur");
      element.classList.add("text-dark");
      element.classList.remove("text-light");

    });

    // .select backdrop-blur class
    document.querySelectorAll(".option").forEach((element) => {
      //element.classList.remove("backdrop-blur");

      if(element.classList.contains("active")){
        element.classList.add("text-light");
        element.classList.remove("text-dark");
      } else {
        element.classList.add("text-dark");
        element.classList.remove("text-light");
      }

      

    });



    if (document.body.classList.contains("text-light")) {
      document.body.classList.replace("text-light", "text-dark");
    } else {
      document.body.classList.add("text-dark");
    }
    
    

    if (CryptoDashLightSwitch.checked) {
      CryptoDashLightSwitch.checked = false;
    }

    showCryptoDashNotification(`<i class="fa fa-sun-o"></i> Light theme set`, 3000);

    window.localStorage.setItem("CryptoDashLightSwitch", "light");
    setCryptoDashConfigDate();
  }
  
  /**
   * @function onToggleMode
   * @summary: the event handler attached to the switch. calling @darkMode or @lightMode depending on the checked state.
   */
  function onToggleMode() {
    if (CryptoDashLightSwitch.checked) {
      darkMode();

    } else {
      lightMode();
    }
  }
  
  /**
   * @function getSystemDefaultTheme
   * @summary: get system default theme by media query
   */
  function getSystemDefaultTheme() {
    const darkThemeMq = window.matchMedia("(prefers-color-scheme: dark)");
    if (darkThemeMq.matches) {
      return "dark";
    }
    return "light";
  }

  function setup() {
    var settings = localStorage.getItem("CryptoDashLightSwitch");
    if (settings == null) {
      settings = getSystemDefaultTheme();
    }
    
    if (settings == "dark") {
      document.getElementById("cryptodash-settings-menu-close").classList.add("bg-light");
      CryptoDashLightSwitch.checked = true;
      

    }
    
    CryptoDashLightSwitch.addEventListener("change", onToggleMode);
    onToggleMode();
  }
  
  setup();
  
})();

// slider to change Auto Refresh
var autoRefreshRanger = document.getElementById("refreshRanger");
autoRefreshRanger.title = autoRefreshRanger.value / 10;

autoRefreshRanger.onchange = function() {
  autoRefreshRanger.title = autoRefreshRanger.value / 10;
  window.localStorage.setItem('CryptoDashAutoRefresh', autoRefreshRanger.value );
  document.getElementById("dataRefreshSpan").innerHTML = autoRefreshRanger.value / 10 + "s";

  showCryptoDashNotification('<i class="fa fa-info-circle"></i> Auto refresh set to ' + autoRefreshRanger.title + ' s', 3000);

}

autoRefreshRanger.oninput = function() {
  
  // trigger the auto refresh function
  stopAutoCryptoDashFetchTrackerData();
  autoCryptoDashFetchTrackerData();
  autoRefreshRanger.title = autoRefreshRanger.value / 10;
  document.getElementById("dataRefreshSpan").innerHTML = autoRefreshRanger.value / 10 + "s";
  document.getElementById("cryptodash-refresh-button").innerHTML = `<i id ="cryptodash-refresh-icon" class="fa fa-refresh "></i> Auto`;

}

// Sldier to change width
var itemSizeRanger = document.getElementById("itemSizeRanger");

itemSizeRanger.onchange = function() {
  // update all trackers in dom with the updated size
  
  // update grid size info
  itemSizeRanger.title = itemSizeRanger.value + 'px';
  document.getElementById("gridsizeSpan").innerHTML = itemSizeRanger.title;

  CryptoDashGrid.refreshItems();
  CryptoDashGrid.layout();

  window.localStorage.setItem('CryptoDashTrackerWidth', itemSizeRanger.value + "px");
  window.localStorage.setItem('CryptoDashTrackerHeight', itemSizeRanger.value / 2 + "px");
  setCryptoDashConfigDate();
  
}

itemSizeRanger.oninput = function() {
  
  document.querySelectorAll(".cryptodash-tracker").forEach((element) => {
    element.style.width = itemSizeRanger.value + "px";
    element.style.height = itemSizeRanger.value / 2 + "px";
  });

  itemSizeRanger.title = itemSizeRanger.value + 'px';
  document.getElementById("gridsizeSpan").innerHTML = itemSizeRanger.title;

  updateCryptoDashTrackerFontSize(); 

  CryptoDashGrid.refreshItems();
  CryptoDashGrid.layout();
}

// Get last 30 days pair for charts
async function getCryptoDashChartLast30Days(coin, currency) {
    
  var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
  var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

  if (CryptoDashDataSource == null) {
    window.localStorage.setItem("CryptoDashDataSource", "CryptoCompareFree");
  }

  function checkCryptoDashDataSourceAPIKey() {
    if (CryptoDashDataSourceAPIKey == null) {
      throw new Error('Data Source API Key not found in Local Storage');
    }
  }

  document.querySelector("#cryptodash-30-days-chart-status").innerHTML = '<i class="fa fa-refresh fa-spin"></i> Loading ...';

  document.querySelector("#cryptodash-30-days-chart-title").innerHTML = "<strong>Last month " + coin + " to " + currency + " chart</strong>";

  if (CryptoDashDataSource === "CryptoCompareFree" ) {

    try {

      const response = await fetch('https://min-api.cryptocompare.com/data/v2/histoday?fsym=' + coin + '&tsym=' + currency + '&limit=30')
          
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const data = await response.json();

      if(data['Response'] === "Error"){

        console.error("Crypto Compare API Error: " + data['Message']);

        document.querySelector("#cryptodash-30-days-chart-content").innerHTML = `<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error: </strong> ` + data['Message'];
        showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
        
      } else {

        document.querySelector("#cryptodash-30-days-chart-content").innerHTML = "";

        var CryptoDashTimeFrom = data['Data']['TimeFrom'];
        var CryptoDashTimeTo = data['Data']['TimeTo'];
        var CryptoDashTimeArray = data['Data']['Data']['0']['high'];
        var CryptoChartData = data;
        //console.log("will return the time from:  " + CryptoDashTimeFrom + " " + CryptoDashTimeTo + " " + CryptoDashTimeArray);

        //return(CryptoDashTimeFrom, CryptoDashTimeTo, CryptoDashTimeArray);
        
        //return CryptoChartData;

        var CryptoDashCurrentTheme = window.localStorage.getItem('CryptoDashLightSwitch');

        var CryptoDashHighSeries = [];
        var CryptoDashLowSeries = [];
        var CryptoDashOpenMarketSeries = [];
        var CryptoDashCloseMarketSeries = [];

        for (const item of data['Data']['Data']) {
          // `item` is the array element, **not** the index
          //console.log(item.time);
          var unixTimestamp = item.time * 1000;
          var timeStamp = new Date(unixTimestamp);
          var highValue = item.high;
          var lowValue = item.low;
          var OpenMarket = item.open;
          var CloseMarket = item.close;

          var pairTimeStampWithHighValue = [];
          var pairTimeStampWithLowValue = [];
          var pairTimeStampWithOpenMarket = [];
          var pairTimeStampWithCloseMarket = [];

          pairTimeStampWithHighValue.push(timeStamp, highValue);
          CryptoDashHighSeries.push(pairTimeStampWithHighValue); 

          pairTimeStampWithLowValue.push(timeStamp, lowValue);
          CryptoDashLowSeries.push(pairTimeStampWithLowValue); 

          pairTimeStampWithOpenMarket.push(timeStamp, OpenMarket);
          CryptoDashOpenMarketSeries.push(pairTimeStampWithOpenMarket); 

          pairTimeStampWithCloseMarket.push(timeStamp, CloseMarket);
          CryptoDashCloseMarketSeries.push(pairTimeStampWithCloseMarket); 
          

        }

        //console.table(CryptoDashHighSeries);

        var options = {
          series: [{
            name: 'Highest Price',
            data: CryptoDashHighSeries
            /*
            [ 
              [new Date(data['Data']['Data']['0']['time']*1000) , data['Data']['Data']['0']['high']], 
              [new Date(data['Data']['Data']['1']['time']*1000) , data['Data']['Data']['1']['high']],
              [new Date(data['Data']['Data']['30']['time']*1000) , data['Data']['Data']['30']['high']]
            ]
            */
          }, {
            name: 'Lowest Price',
            data: CryptoDashLowSeries
            
          }, {
            name: 'Open Market Price',
            data: CryptoDashOpenMarketSeries
            
          }, {
            name: 'Close Market Price',
            data: CryptoDashCloseMarketSeries
            
          }],
          chart: {
            height: 280,
            width: '98%',
            type: 'area',
            toolbar: {
              offsetY: "-25",

            },
            background:'none',
            animations: {
              enabled: true,
              easing: 'easeinout',
              speed: 800,
              animateGradually: {
                  enabled: true,
                  delay: 150
              },
              dynamicAnimation: {
                  enabled: true,
                  speed: 350
              }
            },
            /*
            dropShadow: {
              enabled: true,
              top: 0,
              left: 0,
              blur: 3,
              opacity: 0.5
            }
            */

          },
          dataLabels: {
            enabled: false
          },
          stroke: {
            curve: 'smooth'
          },
          legend: {
            position: 'top',
            fontSize: '14px',
          },
          tooltip: {
            x: {
              format: 'dd MMM yyyy HH:mm'
            },
          },
          xaxis: {
            type: 'datetime',
            labels: {
              style:{
                fontSize: '14px',
              },
            },
          }, 
      
          theme: {
            mode: CryptoDashCurrentTheme,
          }
        };
      
        var chart30Days = new ApexCharts(document.querySelector("#cryptodash-30-days-chart-content"), options);
        chart30Days.render();
      
        chart30Days.hideSeries('Open Market Price');
        chart30Days.hideSeries('Close Market Price');

        // fallback to remove the style background
        var svgchart = document.querySelector("svg");
        svgchart.style.removeProperty("background");
        

        // add event when the offcanvas is closed
        document.getElementById('cryptodash-chart-menu').addEventListener('hidden.bs.offcanvas', function () {
          // do something...

          // remove chart
          chart30Days.destroy();
          document.querySelector("#cryptodash-30-days-chart-content").innerHTML = "";
          //document.querySelector("#cryptodash-1-day-chart-content").innerHTML = "";
          //document.querySelector("#cryptodash-1-hour-chart-content").innerHTML = "";

        })

        /*
        var unixTimestamp = data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['LASTUPDATE'];
        var lastupdate = new Date(unixTimestamp*1000);
        var showlastupdate = lastupdate.getDate() + "-" +(lastupdate.getMonth()+1)+ "-" +lastupdate.getFullYear() + " <br> " + lastupdate.toLocaleTimeString();

        */
        
      }

    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, 10000);
    }

  }

  if (CryptoDashDataSource === "CryptoCompareAPI" ) {
    
    try {
      checkCryptoDashDataSourceAPIKey();

      try {
     
        var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

        try {
          
          const response = await fetch('https://min-api.cryptocompare.com/data/v2/histoday?fsym=' + coin + '&tsym=' + currency + '&limit=30' + '&api_key=' + CryptoDashDataSourceAPIKey)
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          if(data['Response'] === "Error"){

            console.error("Crypto Compare API Error: " + data['Message']);
    
            document.querySelector("#cryptodash-30-days-chart-content").innerHTML = `<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error: </strong> ` + data['Message'];
            showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
        
            
          } else {

            document.querySelector("#cryptodash-30-days-chart-content").innerHTML = "";

            var CryptoDashTimeFrom = data['Data']['TimeFrom'];
            var CryptoDashTimeTo = data['Data']['TimeTo'];
            var CryptoDashTimeArray = data['Data']['Data']['0']['high'];
            var CryptoChartData = data;
            //console.log("will return the time from:  " + CryptoDashTimeFrom + " " + CryptoDashTimeTo + " " + CryptoDashTimeArray);

            //return(CryptoDashTimeFrom, CryptoDashTimeTo, CryptoDashTimeArray);
            
            //return CryptoChartData;

            var CryptoDashCurrentTheme = window.localStorage.getItem('CryptoDashLightSwitch');

            var CryptoDashHighSeries = [];
            var CryptoDashLowSeries = [];
            var CryptoDashOpenMarketSeries = [];
            var CryptoDashCloseMarketSeries = [];

            for (const item of data['Data']['Data']) {
              // `item` is the array element, **not** the index
              //console.log(item.time);
              var unixTimestamp = item.time * 1000;
              var timeStamp = new Date(unixTimestamp);
              var highValue = item.high;
              var lowValue = item.low;
              var OpenMarket = item.open;
              var CloseMarket = item.close;

              var pairTimeStampWithHighValue = [];
              var pairTimeStampWithLowValue = [];
              var pairTimeStampWithOpenMarket = [];
              var pairTimeStampWithCloseMarket = [];

              pairTimeStampWithHighValue.push(timeStamp, highValue);
              CryptoDashHighSeries.push(pairTimeStampWithHighValue); 

              pairTimeStampWithLowValue.push(timeStamp, lowValue);
              CryptoDashLowSeries.push(pairTimeStampWithLowValue); 

              pairTimeStampWithOpenMarket.push(timeStamp, OpenMarket);
              CryptoDashOpenMarketSeries.push(pairTimeStampWithOpenMarket); 

              pairTimeStampWithCloseMarket.push(timeStamp, CloseMarket);
              CryptoDashCloseMarketSeries.push(pairTimeStampWithCloseMarket); 
              

            }

            //console.table(CryptoDashHighSeries);

            var options = {
              series: [{
                name: 'Highest Price',
                data: CryptoDashHighSeries
                /*
                [ 
                  [new Date(data['Data']['Data']['0']['time']*1000) , data['Data']['Data']['0']['high']], 
                  [new Date(data['Data']['Data']['1']['time']*1000) , data['Data']['Data']['1']['high']],
                  [new Date(data['Data']['Data']['30']['time']*1000) , data['Data']['Data']['30']['high']]
                ]
                */
              }, {
                name: 'Lowest Price',
                data: CryptoDashLowSeries
                
              }, {
                name: 'Open Market Price',
                data: CryptoDashOpenMarketSeries
                
              }, {
                name: 'Close Market Price',
                data: CryptoDashCloseMarketSeries
                
              }],
              chart: {
                height: 280,
                width: '98%',
                type: 'area',
                toolbar: {
                  offsetY: "-25",

                },
                background:'none',
                animations: {
                  enabled: true,
                  easing: 'easeinout',
                  speed: 800,
                  animateGradually: {
                      enabled: true,
                      delay: 150
                  },
                  dynamicAnimation: {
                      enabled: true,
                      speed: 350
                  }
                },
                /*
                dropShadow: {
                  enabled: true,
                  top: 0,
                  left: 0,
                  blur: 3,
                  opacity: 0.5
                }
                */

              },
              dataLabels: {
                enabled: false
              },
              stroke: {
                curve: 'smooth'
              },
              legend: {
                position: 'top',
                fontSize: '14px',
              },
              tooltip: {
                x: {
                  format: 'dd MMM yyyy HH:mm'
                },
              },
              xaxis: {
                type: 'datetime',
                labels: {
                  style:{
                    fontSize: '14px',
                  },
                },
            
              }, 
          
              theme: {
                mode: CryptoDashCurrentTheme,
              }
            };
          
            var chart30Days = new ApexCharts(document.querySelector("#cryptodash-30-days-chart-content"), options);
            chart30Days.render();
          
            chart30Days.hideSeries('Open Market Price');
            chart30Days.hideSeries('Close Market Price');

            // fallback to remove the style background
            var svgchart = document.querySelector("svg");
            svgchart.style.removeProperty("background");
            

            // add event when the offcanvas is closed
            document.getElementById('cryptodash-chart-menu').addEventListener('hidden.bs.offcanvas', function () {
              // do something...

              // remove chart
              chart30Days.destroy();
              document.querySelector("#cryptodash-30-days-chart-content").innerHTML = "";
              //document.querySelector("#cryptodash-1-day-chart-content").innerHTML = "";
              //document.querySelector("#cryptodash-1-hour-chart-content").innerHTML = "";

            })

            /*
            var unixTimestamp = data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['LASTUPDATE'];
            var lastupdate = new Date(unixTimestamp*1000);
            var showlastupdate = lastupdate.getDate() + "-" +(lastupdate.getMonth()+1)+ "-" +lastupdate.getFullYear() + " <br> " + lastupdate.toLocaleTimeString();

            */
            
          }

        } catch(e) {
          console.error(e);
          showCryptoDashNotification(e, 10000);
        }

      } catch(e) {
        console.error(e);
        showCryptoDashNotification(e, 10000);
      }

    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, 10000);
    }


  }

  document.querySelector("#cryptodash-30-days-chart-status").innerHTML = '';




}

async function getCryptoDashChartLastDay(coin, currency) {
    
  var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
  var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

  if (CryptoDashDataSource == null) {
    window.localStorage.setItem("CryptoDashDataSource", "CryptoCompareFree");
  }

  function checkCryptoDashDataSourceAPIKey() {
    if (CryptoDashDataSourceAPIKey == null) {
      throw new Error('Data Source API Key not found in Local Storage');
    }
  }

  document.querySelector("#cryptodash-1-day-chart-status").innerHTML = '<i class="fa fa-refresh fa-spin"></i> Loading ...';

  document.querySelector("#cryptodash-1-day-chart-title").innerHTML = "<strong>Last day " + coin + " to " + currency + " chart</strong>";

  if (CryptoDashDataSource === "CryptoCompareFree" ) {

    try {

      const response = await fetch('https://min-api.cryptocompare.com/data/v2/histohour?fsym=' + coin + '&tsym=' + currency + '&limit=24')
          
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const data = await response.json();

      if(data['Response'] === "Error"){

        console.error("Crypto Compare API Error: " + data['Message']);

        document.querySelector("#cryptodash-1-day-chart-content").innerHTML = `<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error: </strong> ` + data['Message'];
        showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
        
      } else {

        document.querySelector("#cryptodash-1-day-chart-content").innerHTML = "";

        var CryptoDashTimeFrom = data['Data']['TimeFrom'];
        var CryptoDashTimeTo = data['Data']['TimeTo'];
        var CryptoDashTimeArray = data['Data']['Data']['0']['high'];
        var CryptoChartData = data;
        //console.log("will return the time from:  " + CryptoDashTimeFrom + " " + CryptoDashTimeTo + " " + CryptoDashTimeArray);

        //return(CryptoDashTimeFrom, CryptoDashTimeTo, CryptoDashTimeArray);
        
        //return CryptoChartData;

        var CryptoDashCurrentTheme = window.localStorage.getItem('CryptoDashLightSwitch');

        var CryptoDashHighSeries = [];
        var CryptoDashLowSeries = [];
        var CryptoDashOpenMarketSeries = [];
        var CryptoDashCloseMarketSeries = [];

        for (const item of data['Data']['Data']) {
          // `item` is the array element, **not** the index
          //console.log(item.time);
          var unixTimestamp = item.time * 1000;
          var timeStamp = new Date(unixTimestamp);
          var highValue = item.high;
          var lowValue = item.low;
          var OpenMarket = item.open;
          var CloseMarket = item.close;

          var pairTimeStampWithHighValue = [];
          var pairTimeStampWithLowValue = [];
          var pairTimeStampWithOpenMarket = [];
          var pairTimeStampWithCloseMarket = [];

          pairTimeStampWithHighValue.push(timeStamp, highValue);
          CryptoDashHighSeries.push(pairTimeStampWithHighValue); 

          pairTimeStampWithLowValue.push(timeStamp, lowValue);
          CryptoDashLowSeries.push(pairTimeStampWithLowValue); 

          pairTimeStampWithOpenMarket.push(timeStamp, OpenMarket);
          CryptoDashOpenMarketSeries.push(pairTimeStampWithOpenMarket); 

          pairTimeStampWithCloseMarket.push(timeStamp, CloseMarket);
          CryptoDashCloseMarketSeries.push(pairTimeStampWithCloseMarket); 
          

        }

        //console.table(CryptoDashHighSeries);

        var options = {
          series: [{
            name: 'Highest Price',
            data: CryptoDashHighSeries
            /*
            [ 
              [new Date(data['Data']['Data']['0']['time']*1000) , data['Data']['Data']['0']['high']], 
              [new Date(data['Data']['Data']['1']['time']*1000) , data['Data']['Data']['1']['high']],
              [new Date(data['Data']['Data']['30']['time']*1000) , data['Data']['Data']['30']['high']]
            ]
            */
          }, {
            name: 'Lowest Price',
            data: CryptoDashLowSeries
            
          }, {
            name: 'Open Market Price',
            data: CryptoDashOpenMarketSeries
            
          }, {
            name: 'Close Market Price',
            data: CryptoDashCloseMarketSeries
          }],
          chart: {
            height: 280,
            width: '98%',
            type: 'area',
            toolbar: {
              offsetY: "-25",
            },
            background:'none',
            animations: {
              enabled: true,
              easing: 'easeinout',
              speed: 800,
              animateGradually: {
                  enabled: true,
                  delay: 150
              },
              dynamicAnimation: {
                  enabled: true,
                  speed: 350
              }
            },
            /*
            dropShadow: {
              enabled: true,
              top: 0,
              left: 0,
              blur: 3,
              opacity: 0.5
            }*/

          },
          dataLabels: {
            enabled: false
          },
          stroke: {
            curve: 'smooth'
          },
          legend: {
            position: 'top',
            fontSize: '14px',
          },
          tooltip: {
            x: {
              format: 'dd MMM yyyy HH:mm'
            },
          },
          xaxis: {
            type: 'datetime',
            labels: {
              style:{
                fontSize: '14px',
              },
            },
          },
          theme: {
            mode: CryptoDashCurrentTheme,
          //  palette: 'palette7',
          }
        };
      
        var chartLastDay = new ApexCharts(document.querySelector("#cryptodash-1-day-chart-content"), options);
        chartLastDay.render();
      
        chartLastDay.hideSeries('Open Market Price');
        chartLastDay.hideSeries('Close Market Price');

        // fallback to remove the style background
        var svgchart = document.querySelector("svg");
        svgchart.style.removeProperty("background");
        

        // add event when the offcanvas is closed
        document.getElementById('cryptodash-chart-menu').addEventListener('hidden.bs.offcanvas', function () {
          // do something...

          // remove chart
          chartLastDay.destroy();
            
          document.querySelector("#cryptodash-1-day-chart-content").innerHTML = "";
          

        })

        /*
        var unixTimestamp = data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['LASTUPDATE'];
        var lastupdate = new Date(unixTimestamp*1000);
        var showlastupdate = lastupdate.getDate() + "-" +(lastupdate.getMonth()+1)+ "-" +lastupdate.getFullYear() + " <br> " + lastupdate.toLocaleTimeString();

        */
        
      }

    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, 10000);
    }

  }

  if (CryptoDashDataSource === "CryptoCompareAPI" ) {
    
    try {
      checkCryptoDashDataSourceAPIKey();

      try {
     
        var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

        try {
          
          const response = await fetch('https://min-api.cryptocompare.com/data/v2/histohour?fsym=' + coin + '&tsym=' + currency + '&limit=24' + '&api_key=' + CryptoDashDataSourceAPIKey)
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          if(data['Response'] === "Error"){

            console.error("Crypto Compare API Error: " + data['Message']);
    
            document.querySelector("#cryptodash-1-day-chart-content").innerHTML = `<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error: </strong>` + data['Message'];
            showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
            
          } else {

            document.querySelector("#cryptodash-1-day-chart-content").innerHTML = "";

            var CryptoDashTimeFrom = data['Data']['TimeFrom'];
            var CryptoDashTimeTo = data['Data']['TimeTo'];
            var CryptoDashTimeArray = data['Data']['Data']['0']['high'];
            var CryptoChartData = data;
            //console.log("will return the time from:  " + CryptoDashTimeFrom + " " + CryptoDashTimeTo + " " + CryptoDashTimeArray);

            //return(CryptoDashTimeFrom, CryptoDashTimeTo, CryptoDashTimeArray);
            
            //return CryptoChartData;

            var CryptoDashCurrentTheme = window.localStorage.getItem('CryptoDashLightSwitch');

            var CryptoDashHighSeries = [];
            var CryptoDashLowSeries = [];
            var CryptoDashOpenMarketSeries = [];
            var CryptoDashCloseMarketSeries = [];

            for (const item of data['Data']['Data']) {
              // `item` is the array element, **not** the index
              //console.log(item.time);
              var unixTimestamp = item.time * 1000;
              var timeStamp = new Date(unixTimestamp);
              var highValue = item.high;
              var lowValue = item.low;
              var OpenMarket = item.open;
              var CloseMarket = item.close;

              var pairTimeStampWithHighValue = [];
              var pairTimeStampWithLowValue = [];
              var pairTimeStampWithOpenMarket = [];
              var pairTimeStampWithCloseMarket = [];

              pairTimeStampWithHighValue.push(timeStamp, highValue);
              CryptoDashHighSeries.push(pairTimeStampWithHighValue); 

              pairTimeStampWithLowValue.push(timeStamp, lowValue);
              CryptoDashLowSeries.push(pairTimeStampWithLowValue); 

              pairTimeStampWithOpenMarket.push(timeStamp, OpenMarket);
              CryptoDashOpenMarketSeries.push(pairTimeStampWithOpenMarket); 

              pairTimeStampWithCloseMarket.push(timeStamp, CloseMarket);
              CryptoDashCloseMarketSeries.push(pairTimeStampWithCloseMarket); 
              

            }

            //console.table(CryptoDashHighSeries);

            var options = {
              series: [{
                name: 'Highest Price',
                data: CryptoDashHighSeries
                /*
                [ 
                  [new Date(data['Data']['Data']['0']['time']*1000) , data['Data']['Data']['0']['high']], 
                  [new Date(data['Data']['Data']['1']['time']*1000) , data['Data']['Data']['1']['high']],
                  [new Date(data['Data']['Data']['30']['time']*1000) , data['Data']['Data']['30']['high']]
                ]
                */
              }, {
                name: 'Lowest Price',
                data: CryptoDashLowSeries
              }, {
                name: 'Open Market Price',
                data: CryptoDashOpenMarketSeries
              }, {
                name: 'Close Market Price',
                data: CryptoDashCloseMarketSeries
              }],
              chart: {
                height: 280,
                width: '98%',
                type: 'area',
                toolbar: {
                  offsetY: "-25",
                },
                background:'none',
                animations: {
                  enabled: true,
                  easing: 'easeinout',
                  speed: 800,
                  animateGradually: {
                      enabled: true,
                      delay: 150
                  },
                  dynamicAnimation: {
                      enabled: true,
                      speed: 350
                  }
                },
                /*
                dropShadow: {
                  enabled: true,
                  top: 0,
                  left: 0,
                  blur: 3,
                  opacity: 0.5
                }*/

              },
              dataLabels: {
                enabled: false
              },
              stroke: {
                curve: 'smooth'
              },
              legend: {
                position: 'top',
                fontSize: '14px',
              },
              tooltip: {
                x: {
                  format: 'dd MMM yyyy HH:mm'
                },
              },
              xaxis: {
                type: 'datetime',
                labels: {
                  style:{
                    fontSize: '14px',
                  },
                },
              }, 
              theme: {
                mode: CryptoDashCurrentTheme,
              //  palette: 'palette7',
              }
            };
          
            var chartLastDay = new ApexCharts(document.querySelector("#cryptodash-1-day-chart-content"), options);
            chartLastDay.render();
          
            chartLastDay.hideSeries('Open Market Price');
            chartLastDay.hideSeries('Close Market Price');

            // fallback to remove the style background
            var svgchart = document.querySelector("svg");
            svgchart.style.removeProperty("background");
            

            // add event when the offcanvas is closed
            document.getElementById('cryptodash-chart-menu').addEventListener('hidden.bs.offcanvas', function () {
              // do something...

              // remove chart
              chartLastDay.destroy();
                
              document.querySelector("#cryptodash-1-day-chart-content").innerHTML = "";
              

            })

            /*
            var unixTimestamp = data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['LASTUPDATE'];
            var lastupdate = new Date(unixTimestamp*1000);
            var showlastupdate = lastupdate.getDate() + "-" +(lastupdate.getMonth()+1)+ "-" +lastupdate.getFullYear() + " <br> " + lastupdate.toLocaleTimeString();

            */
            
          }

        } catch(e) {
          console.error(e);
          showCryptoDashNotification(e, 10000);
        }

      } catch(e) {
        console.error(e);
        showCryptoDashNotification(e, 10000);
      }

    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, 10000);
    }


  }

  document.querySelector("#cryptodash-1-day-chart-status").innerHTML = '';




}

async function getCryptoDashChartLastHour(coin, currency) {
    
  var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
  var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

  if (CryptoDashDataSource == null) {
    window.localStorage.setItem("CryptoDashDataSource", "CryptoCompareFree");
  }

  function checkCryptoDashDataSourceAPIKey() {
    if (CryptoDashDataSourceAPIKey == null) {
      throw new Error('Data Source API Key not found in Local Storage');
    }
  }

  document.querySelector("#cryptodash-1-hour-chart-status").innerHTML = '<i class="fa fa-refresh fa-spin"></i> Loading ...';

  document.querySelector("#cryptodash-1-hour-chart-title").innerHTML = "<strong>Last hour " + coin + " to " + currency + " chart<strong>";

  if (CryptoDashDataSource === "CryptoCompareFree" ) {

    try {

      const response = await fetch('https://min-api.cryptocompare.com/data/v2/histominute?fsym=' + coin + '&tsym=' + currency + '&limit=60')
          
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const data = await response.json();

      if(data['Response'] === "Error"){

        console.error("Crypto Compare API Error: " + data['Message']);

        document.querySelector("#cryptodash-1-hour-chart-content").innerHTML = `<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error: </strong> ` + data['Message'];
        showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
        
      } else {

        document.querySelector("#cryptodash-1-hour-chart-content").innerHTML = "";

        var CryptoDashTimeFrom = data['Data']['TimeFrom'];
        var CryptoDashTimeTo = data['Data']['TimeTo'];
        var CryptoDashTimeArray = data['Data']['Data']['0']['high'];
        var CryptoChartData = data;
        //console.log("will return the time from:  " + CryptoDashTimeFrom + " " + CryptoDashTimeTo + " " + CryptoDashTimeArray);

        //return(CryptoDashTimeFrom, CryptoDashTimeTo, CryptoDashTimeArray);
        
        //return CryptoChartData;

        var CryptoDashCurrentTheme = window.localStorage.getItem('CryptoDashLightSwitch');

        var CryptoDashHighSeries = [];
        var CryptoDashLowSeries = [];
        var CryptoDashOpenMarketSeries = [];
        var CryptoDashCloseMarketSeries = [];

        for (const item of data['Data']['Data']) {
          // `item` is the array element, **not** the index
          //console.log(item.time);
          var unixTimestamp = item.time * 1000;
          var timeStamp = new Date(unixTimestamp);
          var highValue = item.high;
          var lowValue = item.low;
          var OpenMarket = item.open;
          var CloseMarket = item.close;

          var pairTimeStampWithHighValue = [];
          var pairTimeStampWithLowValue = [];
          var pairTimeStampWithOpenMarket = [];
          var pairTimeStampWithCloseMarket = [];

          pairTimeStampWithHighValue.push(timeStamp, highValue);
          CryptoDashHighSeries.push(pairTimeStampWithHighValue); 

          pairTimeStampWithLowValue.push(timeStamp, lowValue);
          CryptoDashLowSeries.push(pairTimeStampWithLowValue); 

          pairTimeStampWithOpenMarket.push(timeStamp, OpenMarket);
          CryptoDashOpenMarketSeries.push(pairTimeStampWithOpenMarket); 

          pairTimeStampWithCloseMarket.push(timeStamp, CloseMarket);
          CryptoDashCloseMarketSeries.push(pairTimeStampWithCloseMarket); 
          

        }

        //console.table(CryptoDashHighSeries);

        var options = {
          series: [{
            name: 'Highest Price',
            data: CryptoDashHighSeries
            /*
            [ 
              [new Date(data['Data']['Data']['0']['time']*1000) , data['Data']['Data']['0']['high']], 
              [new Date(data['Data']['Data']['1']['time']*1000) , data['Data']['Data']['1']['high']],
              [new Date(data['Data']['Data']['30']['time']*1000) , data['Data']['Data']['30']['high']]
            ]
            */
          }, {
            name: 'Lowest Price',
            data: CryptoDashLowSeries
          }, {
            name: 'Open Market Price',
            data: CryptoDashOpenMarketSeries 
          }, {
            name: 'Close Market Price',
            data: CryptoDashCloseMarketSeries
          }],
          chart: {
            height: 280,
            width: '98%',
            type: 'area',
            toolbar: {
                offsetY: "-25",
            },
            background:'none',
            animations: {
              enabled: true,
              easing: 'easeinout',
              speed: 800,
              animateGradually: {
                  enabled: true,
                  delay: 150
              },
              dynamicAnimation: {
                  enabled: true,
                  speed: 350
              }
            },
            /*
            dropShadow: {
              enabled: true,
              top: 0,
              left: 0,
              blur: 3,
              opacity: 0.5
            }*/

          },
          dataLabels: {
            enabled: false
          },
          stroke: {
            curve: 'smooth'
          },
          legend: {
            position: 'top',
            fontSize: '14px',
          },
          tooltip: {
            x: {
              format: 'HH:mm'
            },
          },
          xaxis: {
            type: 'datetime',
            labels: {
              style:{
                fontSize: '14px',
              },
            },
        
          }, 
          theme: {
            mode: CryptoDashCurrentTheme,
          // palette: 'palette8',
          }
        };
      
        var chart1hour = new ApexCharts(document.querySelector("#cryptodash-1-hour-chart-content"), options);
        chart1hour.render();
      
        chart1hour.hideSeries('Open Market Price');
        chart1hour.hideSeries('Close Market Price');

        // fallback to remove the style background
        var svgchart = document.querySelector("svg");
        svgchart.style.removeProperty("background");
        

        // add event when the offcanvas is closed
        document.getElementById('cryptodash-chart-menu').addEventListener('hidden.bs.offcanvas', function () {
          // do something...

          // remove chart
          chart1hour.destroy();
          // document.querySelector("#cryptodash-30-days-chart-content").innerHTML = "";
          // document.querySelector("#cryptodash-1-day-chart-content").innerHTML = "";
          document.querySelector("#cryptodash-1-hour-chart-content").innerHTML = "";

        })

        /*
        var unixTimestamp = data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['LASTUPDATE'];
        var lastupdate = new Date(unixTimestamp*1000);
        var showlastupdate = lastupdate.getDate() + "-" +(lastupdate.getMonth()+1)+ "-" +lastupdate.getFullYear() + " <br> " + lastupdate.toLocaleTimeString();

        */
        
      }

    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, 10000);
    }

  }

  if (CryptoDashDataSource === "CryptoCompareAPI" ) {
    
    try {
      checkCryptoDashDataSourceAPIKey();

      try {
     
        var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

        try {
          
          const response = await fetch('https://min-api.cryptocompare.com/data/v2/histominute?fsym=' + coin + '&tsym=' + currency + '&limit=60' + '&api_key=' + CryptoDashDataSourceAPIKey)
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          if(data['Response'] === "Error"){

            console.error("Crypto Compare API Error: " + data['Message']);
    
            document.querySelector("#cryptodash-1-hour-chart-content").innerHTML = `<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error: </strong> ` + data['Message'];
            showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
            
          } else {

            document.querySelector("#cryptodash-1-hour-chart-content").innerHTML = "";

            var CryptoDashTimeFrom = data['Data']['TimeFrom'];
            var CryptoDashTimeTo = data['Data']['TimeTo'];
            var CryptoDashTimeArray = data['Data']['Data']['0']['high'];
            var CryptoChartData = data;
            //console.log("will return the time from:  " + CryptoDashTimeFrom + " " + CryptoDashTimeTo + " " + CryptoDashTimeArray);
    
            //return(CryptoDashTimeFrom, CryptoDashTimeTo, CryptoDashTimeArray);
            
            //return CryptoChartData;
    
            var CryptoDashCurrentTheme = window.localStorage.getItem('CryptoDashLightSwitch');
    
            var CryptoDashHighSeries = [];
            var CryptoDashLowSeries = [];
            var CryptoDashOpenMarketSeries = [];
            var CryptoDashCloseMarketSeries = [];
    
            for (const item of data['Data']['Data']) {
              // `item` is the array element, **not** the index
              //console.log(item.time);
              var unixTimestamp = item.time * 1000;
              var timeStamp = new Date(unixTimestamp);
              var highValue = item.high;
              var lowValue = item.low;
              var OpenMarket = item.open;
              var CloseMarket = item.close;
    
              var pairTimeStampWithHighValue = [];
              var pairTimeStampWithLowValue = [];
              var pairTimeStampWithOpenMarket = [];
              var pairTimeStampWithCloseMarket = [];
    
              pairTimeStampWithHighValue.push(timeStamp, highValue);
              CryptoDashHighSeries.push(pairTimeStampWithHighValue); 
    
              pairTimeStampWithLowValue.push(timeStamp, lowValue);
              CryptoDashLowSeries.push(pairTimeStampWithLowValue); 
    
              pairTimeStampWithOpenMarket.push(timeStamp, OpenMarket);
              CryptoDashOpenMarketSeries.push(pairTimeStampWithOpenMarket); 
    
              pairTimeStampWithCloseMarket.push(timeStamp, CloseMarket);
              CryptoDashCloseMarketSeries.push(pairTimeStampWithCloseMarket); 
              
    
            }
    
            //console.table(CryptoDashHighSeries);
    
            var options = {
              series: [{
                name: 'Highest Price',
                data: CryptoDashHighSeries
                /*
                [ 
                  [new Date(data['Data']['Data']['0']['time']*1000) , data['Data']['Data']['0']['high']], 
                  [new Date(data['Data']['Data']['1']['time']*1000) , data['Data']['Data']['1']['high']],
                  [new Date(data['Data']['Data']['30']['time']*1000) , data['Data']['Data']['30']['high']]
                ]
                */
                }, {
                name: 'Lowest Price',
                data: CryptoDashLowSeries
                
                }, {
                name: 'Open Market Price',
                data: CryptoDashOpenMarketSeries
                }, {
                name: 'Close Market Price',
                data: CryptoDashCloseMarketSeries
              }],
              chart: {
                height: 280,
                width: '98%',
                type: 'area',
                toolbar: {
                    offsetY: "-25",
                },
                background:'none',
                animations: {
                  enabled: true,
                  easing: 'easeinout',
                  speed: 800,
                  animateGradually: {
                      enabled: true,
                      delay: 150
                  },
                  dynamicAnimation: {
                      enabled: true,
                      speed: 350
                  }
                },

                /*
                dropShadow: {
                  enabled: true,
                  top: 0,
                  left: 0,
                  blur: 3,
                  opacity: 0.5
                }*/
    
              },
              dataLabels: {
                enabled: false
              },
              stroke: {
                curve: 'smooth'
              },
              legend: {
                position: 'top',
                fontSize: '14px',
              },
              tooltip: {
                x: {
                  format: 'HH:mm',
                },
              },
              xaxis: {
                type: 'datetime',
                labels: {
                  style:{
                    fontSize: '14px',
                  },
                },
                
              },             
              theme: {
                mode: CryptoDashCurrentTheme,
              // palette: 'palette8',
              }
            };
          
            var chart1hour = new ApexCharts(document.querySelector("#cryptodash-1-hour-chart-content"), options);
            chart1hour.render();
          
            chart1hour.hideSeries('Open Market Price');
            chart1hour.hideSeries('Close Market Price');
    
            // fallback to remove the style background
            var svgchart = document.querySelector("svg");
            svgchart.style.removeProperty("background");
            
    
            // add event when the offcanvas is closed
            document.getElementById('cryptodash-chart-menu').addEventListener('hidden.bs.offcanvas', function () {
              // do something...
    
              // remove chart
              chart1hour.destroy();
              // document.querySelector("#cryptodash-30-days-chart-content").innerHTML = "";
              // document.querySelector("#cryptodash-1-day-chart-content").innerHTML = "";
              document.querySelector("#cryptodash-1-hour-chart-content").innerHTML = "";
    
            })
    
            /*
            var unixTimestamp = data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['LASTUPDATE'];
            var lastupdate = new Date(unixTimestamp*1000);
            var showlastupdate = lastupdate.getDate() + "-" +(lastupdate.getMonth()+1)+ "-" +lastupdate.getFullYear() + " <br> " + lastupdate.toLocaleTimeString();
    
            */
          }

        } catch(e) {
          console.error(e);
          showCryptoDashNotification(e, 10000);
        }

      } catch(e) {
        console.error(e);
        showCryptoDashNotification(e, 10000);
      }

    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, 10000);
    }


  }

  document.querySelector("#cryptodash-1-hour-chart-status").innerHTML = '';




}

function removeCryptoDashSelectedItem(coin){
  // trigger Tom Select function to remove the item
  CryptoDashCoinsSelector.removeItem(coin);
}

var chartCryptoDashOpener = function (event) {
  //event.preventDefault()
  event.stopPropagation()
  var CryptoDashChartOffCanvas = new bootstrap.Offcanvas(document.getElementById('cryptodash-chart-menu'))
  CryptoDashChartOffCanvas.show()

  var CryptoDashChartTitle = this.id.substring(0, this.id.length - 4); ;
  var CryptoDashChartOffCanvasTitle = document.getElementById('CryptoDashChartMenuLabel');

  CryptoDashChartOffCanvasTitle.innerHTML = '<strong> <i class="fa fa-area-chart"></i> ' + CryptoDashChartTitle + '</strong>';

  //CryptoDashChartMenuLabel

  var CryptoDashCurrentSelectedCurrency = window.localStorage.getItem("CryptoDashCurrency");

  var CryptoDashCurrentTheme = window.localStorage.getItem("CryptoDashLightSwitch");
  if(CryptoDashCurrentTheme === "dark") {
    var CryptoDashButtonTextColor = "light";
  } else {
    var CryptoDashButtonTextColor = "dark";
  }

 // console.log(CryptoDashButtonTextColor);

  document.getElementById('cryptodash-chart-remove-button').innerHTML = `<button class="btn btn-sm btn-outline-` + CryptoDashCurrentTheme + ` text-`+ CryptoDashButtonTextColor +`" onclick="removeCryptoDashSelectedItem('` + CryptoDashChartTitle + `')" data-bs-toggle="offcanvas" data-bs-target="#cryptodash-chart-menu" aria-controls="cryptodash-chart-menu"><i class="fa fa-trash"></i> Remove Tracker</button>`;
  //CryptoDashChartOffCanvas.hide();

  showCryptoDashNotification(`<i class="fa fa-refresh fa-spin"></i> Loading charts ...`, 3000);

  var CryptoChart30DaysData = getCryptoDashChartLast30Days(CryptoDashChartTitle, CryptoDashCurrentSelectedCurrency);
  var CryptoChartLastDayData = getCryptoDashChartLastDay(CryptoDashChartTitle, CryptoDashCurrentSelectedCurrency);
  var CryptoChartLastHourData = getCryptoDashChartLastHour(CryptoDashChartTitle, CryptoDashCurrentSelectedCurrency);
  

 


}

function createCryptoDashTracker(coinAbr) {


  var CryptoDashContentTrackers = document.getElementById("CryptoDashContentTrackers");
  var CryptoDashLightSwitch = window.localStorage.getItem("CryptoDashLightSwitch");
  var Tracker = document.createElement("div");

  var TrackerItemContent = document.createElement("div");
  var TrackerItemContentIDAttribute = document.createAttribute("id");

  var TrackerItemContentTitle = document.createElement("H1");
  var TrackerNameIDAttribute = document.createAttribute("id");

  var TrackerAttribute = document.createAttribute("crypto-dash-id");

  var TrackerIDAttribute = document.createAttribute("id");

  var TrackerPrice = document.createElement("H2");
  var TrackerPriceIDAttribute = document.createAttribute("id");

  var TrackerHighestValue24 = document.createElement("p");
  var TrackerLowestValue24 = document.createElement("p");
  var TrackerHighestValue24IDAttribute = document.createAttribute("id");
  var TrackerLowestValue24IDAttribute = document.createAttribute("id");

  var TrackerHighestValueHour = document.createElement("p");
  var TrackerLowestValueHour = document.createElement("p");
  var TrackerHighestValueHourIDAttribute = document.createAttribute("id");
  var TrackerLowestValueHourIDAttribute = document.createAttribute("id");

  var TrackerChangeValue24 = document.createElement("p");
  var TrackerChangePCTValue24 = document.createElement("p");
  var TrackerChangeValue24IDAttribute = document.createAttribute("id");
  var TrackerChangePCTValue24IDAttribute = document.createAttribute("id");

  var TrackerChangeValueHour = document.createElement("p");
  var TrackerChangePCTValueHour = document.createElement("p");
  var TrackerChangeValueHourIDAttribute = document.createAttribute("id");
  var TrackerChangePCTValueHourIDAttribute = document.createAttribute("id");

  var TrackerImg = document.createElement("img");
  var TrackerImgIDAttribute = document.createAttribute("id");
  var TrackerImgSRCAttribute = document.createAttribute("src");

  //var TrackerImgChartAttributeToggle = document.createAttribute("data-bs-toggle");
  //var TrackerImgChartAttributeTarget = document.createAttribute("data-bs-target");
  //var TrackerImgChartAttributeAria = document.createAttribute("aria-controls");
  //var TrackerImgClassAttribute = document.createAttribute("class");

  var TrackerUpdateTime = document.createElement("p");
  var TrackerUpdateTimeIDAttribute = document.createAttribute("id");


  var settings = window.localStorage.getItem("CryptoDashFrostedThemeSwitch");
    if (settings == null) {
      window.localStorage.setItem("CryptoDashFrostedThemeSwitch", "Frosted");
      Tracker.classList.add("cryptodash-tracker", "tracker-backdrop-blur");
    }
    
    if (settings == "Frosted") {
      Tracker.classList.add("cryptodash-tracker", "tracker-backdrop-blur");

      if(CryptoDashLightSwitch && CryptoDashLightSwitch === "dark") {
        Tracker.classList.remove("bg-dark");
      } else {
        Tracker.classList.remove("bg-light");
      }


    }

    if (settings == "Defrosted") {
      Tracker.classList.add("cryptodash-tracker");

      if(CryptoDashLightSwitch && CryptoDashLightSwitch === "dark") {
        Tracker.classList.add("bg-dark");
      } else {
        Tracker.classList.add("bg-light");
      }

    }

  
  
  /*
  if(CryptoDashLightSwitch && CryptoDashLightSwitch === "dark") {
    Tracker.classList.add("bg-dark");
  } else {
    Tracker.classList.add("bg-light");
  }
  */
//animate__pulse
  Tracker.classList.add("col");
  TrackerItemContent.classList.add("cryptodash-tracker-content" , "animate__animated", "animate__pulse");
  //TrackerItemContent.addEventListener("click", chartCryptoDashOpener);
  
  TrackerAttribute.value = coinAbr;
  TrackerIDAttribute.value = coinAbr;
  TrackerNameIDAttribute.value = coinAbr + "-name";
  TrackerItemContentIDAttribute.value = coinAbr + "-content";
  TrackerPriceIDAttribute.value = coinAbr + "-price";
  
  TrackerHighestValue24IDAttribute.value = coinAbr + "-high24";
  TrackerLowestValue24IDAttribute.value = coinAbr + "-low24";

  TrackerHighestValueHourIDAttribute.value = coinAbr + "-highhour";
  TrackerLowestValueHourIDAttribute.value = coinAbr + "-lowhour";

  TrackerChangeValue24IDAttribute.value = coinAbr + "-change24";
  TrackerChangePCTValue24IDAttribute.value = coinAbr + "-changepct24";

  TrackerChangeValueHourIDAttribute.value = coinAbr + "-changehour";
  TrackerChangePCTValueHourIDAttribute.value = coinAbr + "-changepcthour";

  TrackerImgIDAttribute.value = coinAbr + "-img";
  TrackerImgSRCAttribute.value = "";
  //TrackerImgChartAttributeToggle.value = "offcanvas";
  //TrackerImgChartAttributeTarget.value = "#cryptodash-chart-menu";
  //TrackerImgChartAttributeAria.value = "cryptodash-chart-menu";

  TrackerUpdateTimeIDAttribute.value = coinAbr + "-updatetime";

  Tracker.setAttributeNode(TrackerAttribute);
  Tracker.setAttributeNode(TrackerIDAttribute);

  TrackerItemContent.setAttributeNode(TrackerItemContentIDAttribute);
  TrackerItemContentTitle.setAttributeNode(TrackerNameIDAttribute);
  TrackerPrice.setAttributeNode(TrackerPriceIDAttribute);

  TrackerHighestValue24.setAttributeNode(TrackerHighestValue24IDAttribute);
  TrackerLowestValue24.setAttributeNode(TrackerLowestValue24IDAttribute);

  TrackerHighestValueHour.setAttributeNode(TrackerHighestValueHourIDAttribute);
  TrackerLowestValueHour.setAttributeNode(TrackerLowestValueHourIDAttribute);

  TrackerChangeValue24.setAttributeNode(TrackerChangeValue24IDAttribute);
  TrackerChangePCTValue24.setAttributeNode(TrackerChangePCTValue24IDAttribute);

  TrackerChangeValueHour.setAttributeNode(TrackerChangeValueHourIDAttribute);
  TrackerChangePCTValueHour.setAttributeNode(TrackerChangePCTValueHourIDAttribute);

  TrackerImg.setAttributeNode(TrackerImgIDAttribute);
  TrackerImg.setAttributeNode(TrackerImgSRCAttribute);
  //TrackerImg.setAttributeNode(TrackerImgChartAttributeToggle);
  //TrackerImg.setAttributeNode(TrackerImgChartAttributeTarget);
  //TrackerImg.setAttributeNode(TrackerImgChartAttributeAria);
  //TrackerImg.setAttributeNode(TrackerImgClassAttribute);
  TrackerImg.addEventListener("click", chartCryptoDashOpener);
  

  TrackerUpdateTime.setAttributeNode(TrackerUpdateTimeIDAttribute);

  TrackerItemContentTitle.innerText = coinAbr;
  
  TrackerItemContent.appendChild(TrackerItemContentTitle);
  TrackerItemContent.appendChild(TrackerPrice);
  TrackerItemContent.appendChild(TrackerHighestValue24);
  TrackerItemContent.appendChild(TrackerLowestValue24);
  TrackerItemContent.appendChild(TrackerHighestValueHour);
  TrackerItemContent.appendChild(TrackerLowestValueHour);
  TrackerItemContent.appendChild(TrackerChangeValue24);
  TrackerItemContent.appendChild(TrackerChangePCTValue24);
  TrackerItemContent.appendChild(TrackerChangeValueHour);
  TrackerItemContent.appendChild(TrackerChangePCTValueHour);
  TrackerItemContent.appendChild(TrackerImg);
  TrackerItemContent.appendChild(TrackerUpdateTime);

  Tracker.appendChild(TrackerItemContent);


  // add the Tracker to the screen 
  CryptoDashContentTrackers.appendChild(Tracker);
  CryptoDashGrid.add(Tracker);

  // get current Tracker size
  var CurrentCryptoDashTrackerWidth = window.localStorage.getItem('CryptoDashTrackerWidth');
  var CurrentCryptoDashTrackerHeight = window.localStorage.getItem('CryptoDashTrackerHeight');

  // reszie the Trackers to be the same size
  Tracker.style.width = CurrentCryptoDashTrackerWidth;
  Tracker.style.height = CurrentCryptoDashTrackerHeight;
  
  
  CryptoDashGrid.synchronize();
  CryptoDashGrid.refreshItems();
  CryptoDashGrid.layout();
  saveCryptoDashLayout(CryptoDashGrid);
  
  // show refresh button
  document.getElementById("cryptodash-refresh-button").removeAttribute("hidden");
 
}

function removeCryptoDashTracker(coinAbr) {


  var TrackerIDString = String(coinAbr);

  // get current layout and position of element
  var CurrentCryptoDashLayout = JSON.parse(window.localStorage.getItem('CryptoDashLayout'));
  var itemIndex = CurrentCryptoDashLayout.indexOf(TrackerIDString);

  // remove element from layout
  CurrentCryptoDashLayout.splice(itemIndex, 1);

  // save the updated layout
  var UpdatedCryptoDashLayout = JSON.stringify(CurrentCryptoDashLayout);
  window.localStorage.setItem('CryptoDashLayout', UpdatedCryptoDashLayout);

  // get the current Tracker
  var trackerToBeRemoved = document.getElementById(TrackerIDString);

  // remove Tracker from grid and dom
  if (trackerToBeRemoved) {
    trackerToBeRemoved.style.display = "none";
  }
  
  if(window.localStorage.getItem('CryptoDashLayout') == "[]") {
    window.localStorage.removeItem('CryptoDashLayout');
    window.localStorage.removeItem('CryptoDashData');
  }

  CryptoDashGrid.refreshSortData();
  CryptoDashGrid.remove(TrackerIDString);
  trackerToBeRemoved.remove();
  
  // sync grid

  CryptoDashGrid.synchronize();
  CryptoDashGrid.refreshItems();
  CryptoDashGrid.layout();
  

  

}

// Get Data

//get interval
var refreshCryptoDashDataInterval = window.localStorage.getItem("CryptoDashAutoRefresh");

// if interval not available set 60 
if(!refreshCryptoDashDataInterval){
  window.localStorage.setItem('CryptoDashAutoRefresh', '110' );

  refreshCryptoDashDataInterval = window.localStorage.getItem("CryptoDashAutoRefresh");

  document.getElementById('refreshRanger').title = refreshCryptoDashDataInterval / 10;
  document.getElementById('refreshRanger').value = refreshCryptoDashDataInterval;
}

var autoDataPull = null;

function autoCryptoDashFetchTrackerData(){

  var refreshCryptoDashDataInterval = autoRefreshRanger.value;
  autoDataPull = setInterval(manualCryptoDashFetchTrackerData, refreshCryptoDashDataInterval * 100);

  //showCryptoDashNotification("Data set to refresh automatically", 3000);
  document.getElementById("cryptodash-refresh-button").innerHTML = `<i id ="cryptodash-refresh-icon" class="fa fa-refresh "></i> Auto`;
} 

function setCryptoDashDataSourceRateCheckResultEmpty() {
  var CryptoDashDataSourceRateLimitResult = document.getElementById("cryptodash-rate-limit-datasource-result");
  CryptoDashDataSourceRateLimitResult.innerHTML = ``;
}

async function checkDataSourceRateLimit() {

  var CryptoDashDataSourceRateLimitButton = document.getElementById('cryptodash-rate-limit-datasource-button');
  var CryptoDashDataSourceRateLimitResult = document.getElementById("cryptodash-rate-limit-datasource-result");

  // hide button
  CryptoDashDataSourceRateLimitButton.style.display = "hidden";
  CryptoDashDataSourceRateLimitResult.innerHTML = `<i class="fa fa-refresh fa-spin"></i> Loading ...`;
  showCryptoDashNotification(`<i class="fa fa-refresh fa-spin"></i> Loading ...`, 3000);


  // https://min-api.cryptocompare.com/stats/rate/limit


  // First Check data source selection 
  // check if API key is in use. 
 
  var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
  var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");


  function checkCryptoDashDataSourceAPIKey() {

    if (CryptoDashDataSourceAPIKey == null) {
      CryptoDashDataSourceRateLimitButton.style.display = "inline-block";
      CryptoDashDataSourceRateLimitResult.innerHTML = ``;
      //showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Data Source Error</strong> <br>` + `Cannot read Data Source API Key`, -1, true);
      throw new Error('Data Source API Key not found in Local Storage');
      //showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Data Source Error</strong> <br>` + `Cannot read Data Source`, -1, true);
    }

  }
  
  if (CryptoDashDataSource == null) {
    CryptoDashDataSourceRateLimitButton.style.display = "inline-block";
    CryptoDashDataSourceRateLimitResult.innerHTML = ``;
    showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Data Source Error</strong> <br>` + `Cannot read Data Source`, -1, true);
  }
  
  if (CryptoDashDataSource === "CryptoCompareFree" ) {
    
    try {
     
      var response = await fetch('https://min-api.cryptocompare.com/stats/rate/limit')
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      var data = await response.json();

      //var CryptoDashData = JSON.stringify(data);

      

      if(data['Response'] === "Error"){

        console.error("Crypto Compare API Error: " + data['Message']);

        showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
        
      } else {

     
        var CryptoDashLightSwitch = window.localStorage.getItem("CryptoDashLightSwitch");

        if(CryptoDashLightSwitch == 'dark') {
          var CryptoDashCurrentTheme = "light";
        } else {
          var CryptoDashCurrentTheme = "dark";
        }

        var cryptodashcallsmadeCCFree = helperCryptoDashObjectToHTMLTable(data['Data']['calls_made']);
        var cryptodashcallsleftCCFree = helperCryptoDashObjectToHTMLTable(data['Data']['calls_left']);

        CryptoDashDataSourceRateLimitButton.style.display = "inline-block";
        CryptoDashDataSourceRateLimitResult.innerHTML = '<p>You are currently using the <strong> FREE Crypto Compare </strong></p>'+'<strong>Current API Calls</strong> <br>' + cryptodashcallsmadeCCFree + '<br> <strong>Current API Calls Left</strong> <br>' + cryptodashcallsleftCCFree + '<div class="d-grid gap-2"><button class="btn btn-sm btn-outline-' + CryptoDashCurrentTheme + '" onclick="setCryptoDashDataSourceRateCheckResultEmpty()"><i class="fa fa-close"></i> Clear Results</button></div>';

        showCryptoDashNotification(`<i class="fa fa-info-circle"></i> <strong>Current API Calls</strong> <br>` + cryptodashcallsmadeCCFree,  -1, true);
        showCryptoDashNotification(`<i class="fa fa-info-circle"></i> <strong>Current API Calls Left</strong> <br>` + cryptodashcallsleftCCFree,  -1, true);


      }   
        
    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, -1, true);
    }

    

  }

  if (CryptoDashDataSource === "CryptoCompareAPI" ) {
    
    try {
      checkCryptoDashDataSourceAPIKey();

      try {
     
        var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

        var response = await fetch('https://min-api.cryptocompare.com/stats/rate/limit?api_key=' + CryptoDashDataSourceAPIKey)
        console.log(response);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
  
        var data = await response.json();
  
        //var CryptoDashData = JSON.stringify(data);
  
        
  
        if(data['Response'] === "Error"){
  
         console.error("Crypto Compare API Error: " + data['Message']);
  
         showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
          
        } else {
  
          // data['Data']['calls_made']
          // data['Data']['calls_left']
          var CryptoDashLightSwitch = window.localStorage.getItem("CryptoDashLightSwitch");

          if(CryptoDashLightSwitch == 'dark') {
            var CryptoDashCurrentTheme = "light";
          } else {
            var CryptoDashCurrentTheme = "dark";
          }

       
          var cryptodashcallsmadeCCApi = helperCryptoDashObjectToHTMLTable(data['Data']['calls_made']);
          var cryptodashcallsleftCCApi = helperCryptoDashObjectToHTMLTable(data['Data']['calls_left']);
  
          CryptoDashDataSourceRateLimitButton.style.display = "inline-block";
          CryptoDashDataSourceRateLimitResult.innerHTML = '<p>You are currently using the <strong> API Crypto Compare </strong></p>'+'<strong>Current API Calls</strong> <br>' + cryptodashcallsmadeCCApi + '<br> <strong>Current API Calls Left</strong> <br>' + cryptodashcallsleftCCApi + '<div class="d-grid gap-2"><button class="btn btn-sm btn-outline-' + CryptoDashCurrentTheme +'" onclick="setCryptoDashDataSourceRateCheckResultEmpty()"><i class="fa fa-close"></i> Clear Results</button></div>';
          
            
          showCryptoDashNotification(`<i class="fa fa-info-circle"></i> <strong>Current API Calls</strong> <br>` + cryptodashcallsmadeCCApi,  -1, true);
          showCryptoDashNotification(`<i class="fa fa-info-circle"></i> <strong>Current API Calls Left</strong> <br>` + cryptodashcallsleftCCApi,  -1, true);
  
  
        }   
          
      } catch(e) {
        console.error(e);
        showCryptoDashNotification(e, -1, true);
      }
    
    } catch(e) {
      console.error(e);
      showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + e, -1, true);
    }
    

  }

  if (CryptoDashDataSource === "LiveCoinWatchAPI" ) {
    
    showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Live Coin Watch API Error</strong> <br>` + `Functionality not yet implemented`, -1, true);
    

  }

  if (CryptoDashDataSource === "CoinMarketCapAPI" ) {
    
    showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Coin Market Cap API Error</strong> <br>` + `Functionality not yet implemented`, -1, true);
    

  }


}

// Manual Crypto Dash data pull
async function manualCryptoDashFetchTrackerData() {

  var CryptoDashRefreshButton = document.getElementById('cryptodash-refresh-button');
  document.getElementById('cryptodash-refresh-icon').classList.add("fa-spin");
  
  var CryptoDashTrackerInfo = JSON.parse(window.localStorage.getItem('CryptoDashLayout'));

  // get the API key from local storage 
  // api key stored when interracting with data source

  var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
  var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

  showCryptoDashNotification(`<i class="fa fa-refresh fa-spin"></i> Loading ...`, 3000);

  if (CryptoDashDataSource == null) {
    //showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Data Source Error</strong> <br>` + `Cannot read Data Source`, -1, true);
    window.localStorage.setItem("CryptoDashDataSource", "CryptoCompareFree");

  }

  function checkCryptoDashDataSourceAPIKey() {

    if (CryptoDashDataSourceAPIKey == null) {
    
      throw new Error('Data Source API Key not found in Local Storage');
      
    }

  }
  
  if (CryptoDashDataSource === "CryptoCompareFree" ) {
    
    try {
      //console.log(CryptoDashTrackerInfo);
     
      if(!CryptoDashTrackerInfo || CryptoDashTrackerInfo === "[]" || CryptoDashTrackerInfo.length == "0") {
        
        showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Data Refresh Error</strong> <br>` + `Nothing is currently tracked`, -1, true);

        // disable the auto refresh 
        document.getElementById("refreshRanger").disabled = true;

        var CryptoDashDataRefreshSwitch = document.getElementById("CryptoDashDataRefreshSwitch");

        if (CryptoDashDataRefreshSwitch.checked) {
          CryptoDashDataRefreshSwitch.checked = false;
        }
        localStorage.setItem("CryptoDashDataRefreshSwitch", "Manual");
        showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Data set to refresh manually to prevent unnecessary API requests`, 3000);
        document.getElementById("dataRefreshSpan").innerHTML = "N/A"; 
        document.getElementById("cryptodash-refresh-button").innerHTML = `<i id ="cryptodash-refresh-icon" class="fa fa-refresh "></i>`;
        stopAutoCryptoDashFetchTrackerData();


        console.log("Nothing is tracked");

      } else {

        // mapping the array with the tracker info
        var preparedCryptoDashTrackerInfo = CryptoDashTrackerInfo.map(function(value) {
          return value;
        }).join(',');
        
      
        // to define 
        //CryptoDashCurrency
        var priceCurrency = "USD,EUR,GBP";
        
        try {
        
          const response = await fetch('https://min-api.cryptocompare.com/data/pricemultifull?fsyms=' + preparedCryptoDashTrackerInfo + '&tsyms=' + priceCurrency)
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          var CryptoDashData = JSON.stringify(data);

          window.localStorage.removeItem('CryptoDashData');

          window.localStorage.setItem('CryptoDashData', CryptoDashData );
          
          if(data['Response'] === "Error"){

            console.error("Crypto Compare API Error: " + data['Message']);
    
            showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
            
          } else {

            // for each tracking element
            document.querySelectorAll(".cryptodash-tracker").forEach((element) => {

              var cryptoDashTrackerID = element.getAttribute('crypto-dash-id');
              //var CurrentTracker = document.getElementById(cryptoDashTrackerID);

              var CryptoDashCurrency = window.localStorage.getItem('CryptoDashCurrency');
            
              // try to do all the tracking work and update each tracker
              try {

                // try get the price set for current currency
                try {
                  document.getElementById(cryptoDashTrackerID + "-price").innerHTML = data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['PRICE'];
                } catch (e) {
                  document.getElementById(cryptoDashTrackerID + "-price").innerHTML = "Data N/A";
                  console.error("Data not available for tracker: " + cryptoDashTrackerID);
                  // Usually if price is not available then none of the data is available 
                }

                // TrackerPrice.innerText = data['DISPLAY'][cryptoDashTrackerID][mycurrency]['PRICE'];
                // CurrentTracker.firstChild.appendChild(TrackerPrice);
                
                // document.getElementById(cryptoDashTrackerID + "-high24").innerHTML = "24 Hour High: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['HIGH24HOUR'];
                // document.getElementById(cryptoDashTrackerID + "-low24").innerHTML = "24 Hour Low: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['LOW24HOUR'];
                // document.getElementById(cryptoDashTrackerID + "-highhour").innerHTML = "Last Hour High: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['HIGHHOUR'];
                // document.getElementById(cryptoDashTrackerID + "-lowhour").innerHTML = "Last Hour Low: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['LOWHOUR'];
                // document.getElementById(cryptoDashTrackerID + "-changehour").innerHTML = "Change in last Hour: " + BigNumber(data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEHOUR']);
                // document.getElementById(cryptoDashTrackerID + "-change24").innerHTML = "Change in last 24 Hours: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGE24HOUR'];


                // try get last change in 24 hours
                try {
                  document.getElementById(cryptoDashTrackerID + "-changepct24").innerHTML = "24H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCT24HOUR'] + " %";
                } catch (e) {
                  //document.getElementById(cryptoDashTrackerID + "-changepct24").innerHTML = "N/A";
                  //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                }

                // try and get last hour change 
                try {
                  document.getElementById(cryptoDashTrackerID + "-changepcthour").innerHTML = "H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCTHOUR'] + " %";
                } catch (e) {
                  //document.getElementById(cryptoDashTrackerID + "-changepcthour").innerHTML = "N/A";
                  //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                }
                
                // try to set the logo
                try {

                  var CryptoDashDataSourceURL = "https://www.cryptocompare.com" + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['IMAGEURL'];

                  var CurrentCryptoDashTracker = document.getElementById(cryptoDashTrackerID);

                  var CryptoDashTrackerImg = document.getElementById(cryptoDashTrackerID + "-img");
                  CryptoDashTrackerImg.src = CryptoDashDataSourceURL;
                  
                  var CryptoDashTracker = document.getElementById(cryptoDashTrackerID);

                  // ENABLE with auto background button ( new feature)
                  //CryptoDashTracker.style.backgroundImage = 'url(\"' + CryptoDashDataSourceURL + '\")';
                  //CryptoDashTracker.style.opacity = '1';

                } catch (e) {
                  //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                  //console.error(e);

                }
                
                // try to set the last update date 
                try {

                  var unixTimestamp = data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['LASTUPDATE'];
                  var lastupdate = new Date(unixTimestamp*1000);
                  var showlastupdate = lastupdate.getDate() + "-" +(lastupdate.getMonth()+1)+ "-" +lastupdate.getFullYear() + " <br> " + lastupdate.toLocaleTimeString();
                
                  document.getElementById(cryptoDashTrackerID + "-updatetime").innerHTML = showlastupdate;

                } catch (e) {
                  //document.getElementById(cryptoDashTrackerID + "-updatetime").innerHTML = "N/A";
                  // make sure the right color is added
                  var CryptoDashLightSwitch = window.localStorage.getItem("CryptoDashLightSwitch");

                  if(CryptoDashLightSwitch == 'dark') {
                    var CryptoDashCurrentTheme = "light";
                  } else {
                    var CryptoDashCurrentTheme = "dark";
                  }


                  // insert button to remove the bad tracker if it fails
                  document.getElementById(cryptoDashTrackerID + "-updatetime").innerHTML = `<button class='btn btn-outline-` + CryptoDashCurrentTheme + ` btn-sm' onclick='CryptoDashCoinsSelector.removeItem("`+cryptoDashTrackerID+`")'>Remove</button>`;
                  
                  


                  //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                  //console.error(e);
                }
                
                //try to flash color red/green 
                try {
                  if (Math.sign(data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCT24HOUR']) > 0) {
                    // add 24 hour percent change info and correct symbol to tracker and display it
                    document.getElementById(cryptoDashTrackerID + "-changepct24").innerHTML = '<i class="fa fa-angle-double-up"></i> ' + "24H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCT24HOUR'] + "%";
                    // set text color and shadow for status symbol 
                    document.getElementById(cryptoDashTrackerID + "-changepct24").querySelectorAll(".fa-angle-double-up").forEach((element) => {
                      element.style.setProperty('text-shadow', "0px 0px 8px #000");
                      element.style.setProperty('color', "#39FF14");
                    });

                  } else {
                    // add 24 hour percent change info and correct symbol to tracker and display it
                    document.getElementById(cryptoDashTrackerID + "-changepct24").innerHTML = '<i class="fa fa-angle-double-down"></i> ' + "24H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCT24HOUR'] + "%";
                    // set text red color and shadow for status symbol 
                    document.getElementById(cryptoDashTrackerID + "-changepct24").querySelectorAll(".fa-angle-double-down").forEach((element) => {
                      element.style.setProperty('text-shadow', "0px 0px 8px #000");
                      element.style.setProperty('color', "#F73718");
                    });
                  }

                  if (Math.sign(data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCTHOUR']) > 0) {
                    // remove image negative colors
                    CryptoDashTrackerImg.classList.remove("cryptodash-negative");
                    // add image positive colors
                    CryptoDashTrackerImg.classList.add("cryptodash-positive");
                    // flash tracker with green border
                    document.getElementById(cryptoDashTrackerID).classList.add("cryptodash-content-positive");
                    // add hour percent change info and correct symbol to tracker and display it
                    document.getElementById(cryptoDashTrackerID + "-changepcthour").innerHTML = '<i class="fa fa-angle-double-up"></i> ' + "H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCTHOUR'] + "%";
                    // set text green color and shadow for status symbol 
                    document.getElementById(cryptoDashTrackerID + "-changepcthour").querySelectorAll(".fa-angle-double-up").forEach((element) => {
                      element.style.setProperty('text-shadow', "0px 0px 8px #000");
                      element.style.setProperty('color', "#39FF14");
                    });

                  } else {
                    // remove image positive colors
                    CryptoDashTrackerImg.classList.remove("cryptodash-positive");
                    // add image negative colors
                    CryptoDashTrackerImg.classList.add("cryptodash-negative");
                    // remove the tracker flash with green border
                    document.getElementById(cryptoDashTrackerID).classList.remove("cryptodash-content-positive");
                    // add hour percent change info and correct symbol to tracker and display it
                    document.getElementById(cryptoDashTrackerID + "-changepcthour").innerHTML = '<i class="fa fa-angle-double-down"></i> ' + "H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCTHOUR'] + "%";
                    // set text red color and shadow for status symbol 
                    document.getElementById(cryptoDashTrackerID + "-changepcthour").querySelectorAll(".fa-angle-double-down").forEach((element) => {
                      element.style.setProperty('text-shadow', "0px 0px 8px #000");
                      element.style.setProperty('color', "#F73718");
                    });
                  }

                  


                } catch (e) {
                  //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                  //console.error(e);
                }

              } catch (e) {
                console.error(e);
                showCryptoDashNotification(e, 10000);
              }
  
            });

          }        

        } catch(e) {
          console.error(e);
          showCryptoDashNotification(e, 10000);
        }

        //return data;

      };

      document.getElementById('cryptodash-refresh-icon').classList.remove("fa-spin"); 
        
    } catch(e) {
      console.error(e);
      showCryptoDashNotification(e, -1, true);
    }

  }

  if (CryptoDashDataSource === "CryptoCompareAPI" ) {
    
    try {
      checkCryptoDashDataSourceAPIKey();

      try {
     
        var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");

        
        if(!CryptoDashTrackerInfo || CryptoDashTrackerInfo === "[]" || CryptoDashTrackerInfo.length == "0") {
          
          showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Data Refresh Error</strong> <br>` + `Nothing is currently tracked`, -1, true);

          console.log("Nothing is tracked");

        } else {

          // mapping the array with the tracker info
          var preparedCryptoDashTrackerInfo = CryptoDashTrackerInfo.map(function(value) {
            return value;
          }).join(',');
          
        
          // to define 
          //CryptoDashCurrency
          var priceCurrency = "USD,EUR,GBP";
          
          
          try {
          
            const response = await fetch('https://min-api.cryptocompare.com/data/pricemultifull?fsyms=' + preparedCryptoDashTrackerInfo + '&tsyms=' + priceCurrency + '&api_key=' + CryptoDashDataSourceAPIKey)
            
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();

            var CryptoDashData = JSON.stringify(data);

            window.localStorage.removeItem('CryptoDashData');

            window.localStorage.setItem('CryptoDashData', CryptoDashData );
            
            if(data['Response'] === "Error"){

              console.error("Crypto Compare API Error: " + data['Message']);
      
              showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + data['Message'], -1, true);
              
            } else {

              // for each tracking element
              document.querySelectorAll(".cryptodash-tracker").forEach((element) => {

                var cryptoDashTrackerID = element.getAttribute('crypto-dash-id');
                //var CurrentTracker = document.getElementById(cryptoDashTrackerID);

                var CryptoDashCurrency = window.localStorage.getItem('CryptoDashCurrency');
              
                // try to do all the tracking work and update each tracker
                try {

                  // try get the price set for current currency
                  try {
                    document.getElementById(cryptoDashTrackerID + "-price").innerHTML = data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['PRICE'];
                  } catch (e) {
                    document.getElementById(cryptoDashTrackerID + "-price").innerHTML = "Data N/A";
                    console.error("Data not available for tracker: " + cryptoDashTrackerID);
                    // Usually if price is not available then none of the data is available 
                  }

                  // TrackerPrice.innerText = data['DISPLAY'][cryptoDashTrackerID][mycurrency]['PRICE'];
                  // CurrentTracker.firstChild.appendChild(TrackerPrice);
                  
                

                

                  // document.getElementById(cryptoDashTrackerID + "-high24").innerHTML = "24 Hour High: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['HIGH24HOUR'];
                  // document.getElementById(cryptoDashTrackerID + "-low24").innerHTML = "24 Hour Low: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['LOW24HOUR'];
                  // document.getElementById(cryptoDashTrackerID + "-highhour").innerHTML = "Last Hour High: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['HIGHHOUR'];
                  // document.getElementById(cryptoDashTrackerID + "-lowhour").innerHTML = "Last Hour Low: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['LOWHOUR'];
                  // document.getElementById(cryptoDashTrackerID + "-changehour").innerHTML = "Change in last Hour: " + BigNumber(data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEHOUR']);
                  // document.getElementById(cryptoDashTrackerID + "-change24").innerHTML = "Change in last 24 Hours: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGE24HOUR'];


                  // try get last change in 24 hours
                  try {
                    document.getElementById(cryptoDashTrackerID + "-changepct24").innerHTML = "24H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCT24HOUR'] + " %";
                  } catch (e) {
                    //document.getElementById(cryptoDashTrackerID + "-changepct24").innerHTML = "N/A";
                    //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                  }

                  // try and get last hour change 
                  try {
                    document.getElementById(cryptoDashTrackerID + "-changepcthour").innerHTML = "H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCTHOUR'] + " %";
                  } catch (e) {
                    //document.getElementById(cryptoDashTrackerID + "-changepcthour").innerHTML = "N/A";
                    //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                  }
                  
                  // try to set the logo
                  try {

                    var CryptoDashDataSourceURL = "https://www.cryptocompare.com" + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['IMAGEURL'];

                    var CurrentCryptoDashTracker = document.getElementById(cryptoDashTrackerID);

                    var CryptoDashTrackerImg = document.getElementById(cryptoDashTrackerID + "-img");
                    CryptoDashTrackerImg.src = CryptoDashDataSourceURL;
                    
                    var CryptoDashTracker = document.getElementById(cryptoDashTrackerID);

                    // ENABLE with auto background button ( new feature)
                    //CryptoDashTracker.style.backgroundImage = 'url(\"' + CryptoDashDataSourceURL + '\")';
                    //CryptoDashTracker.style.opacity = '1';

                  } catch (e) {
                    //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                    //console.error(e);

                  }
                  
                  // try to set the last update date 
                  try {

                    var unixTimestamp = data['RAW'][cryptoDashTrackerID][CryptoDashCurrency]['LASTUPDATE'];
                    var lastupdate = new Date(unixTimestamp*1000);
                    var showlastupdate = lastupdate.getDate() + "-" +(lastupdate.getMonth()+1)+ "-" +lastupdate.getFullYear() + " <br> " + lastupdate.toLocaleTimeString();
                  
                    document.getElementById(cryptoDashTrackerID + "-updatetime").innerHTML = showlastupdate;

                  } catch (e) {
                    //document.getElementById(cryptoDashTrackerID + "-updatetime").innerHTML = "N/A";

                    // insert button to remove the bad tracker if it fails
                    document.getElementById(cryptoDashTrackerID + "-updatetime").innerHTML = `<button class='btn btn-outline-dark btn-sm' onclick='CryptoDashCoinsSelector.removeItem("`+cryptoDashTrackerID+`")'>Remove</button>`;
                    
                    //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                    //console.error(e);
                  }
                  
                  //try to flash color red/green 
                  try {
                    if (Math.sign(data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCT24HOUR']) > 0) {
                      // add 24 hour percent change info and correct symbol to tracker and display it
                      document.getElementById(cryptoDashTrackerID + "-changepct24").innerHTML = '<i class="fa fa-angle-double-up"></i> ' + "24H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCT24HOUR'] + "%";
                      // set text color and shadow for status symbol 
                      document.getElementById(cryptoDashTrackerID + "-changepct24").querySelectorAll(".fa-angle-double-up").forEach((element) => {
                        element.style.setProperty('text-shadow', "0px 0px 8px #000");
                        element.style.setProperty('color', "#39FF14");
                      });
  
                    } else {
                      // add 24 hour percent change info and correct symbol to tracker and display it
                      document.getElementById(cryptoDashTrackerID + "-changepct24").innerHTML = '<i class="fa fa-angle-double-down"></i> ' + "24H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCT24HOUR'] + "%";
                      // set text red color and shadow for status symbol 
                      document.getElementById(cryptoDashTrackerID + "-changepct24").querySelectorAll(".fa-angle-double-down").forEach((element) => {
                        element.style.setProperty('text-shadow', "0px 0px 8px #000");
                        element.style.setProperty('color', "#F73718");
                      });
                    }
  
                    if (Math.sign(data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCTHOUR']) > 0) {
                      // remove image negative colors
                      CryptoDashTrackerImg.classList.remove("cryptodash-negative");
                      // add image positive colors
                      CryptoDashTrackerImg.classList.add("cryptodash-positive");
                      // flash tracker with green border
                      document.getElementById(cryptoDashTrackerID).classList.add("cryptodash-content-positive");
                      // add hour percent change info and correct symbol to tracker and display it
                      document.getElementById(cryptoDashTrackerID + "-changepcthour").innerHTML = '<i class="fa fa-angle-double-up"></i> ' + "H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCTHOUR'] + "%";
                      // set text green color and shadow for status symbol 
                      document.getElementById(cryptoDashTrackerID + "-changepcthour").querySelectorAll(".fa-angle-double-up").forEach((element) => {
                        element.style.setProperty('text-shadow', "0px 0px 8px #000");
                        element.style.setProperty('color', "#39FF14");
                      });
  
                    } else {
                      // remove image positive colors
                      CryptoDashTrackerImg.classList.remove("cryptodash-positive");
                      // add image negative colors
                      CryptoDashTrackerImg.classList.add("cryptodash-negative");
                      // remove the tracker flash with green border
                      document.getElementById(cryptoDashTrackerID).classList.remove("cryptodash-content-positive");
                      // add hour percent change info and correct symbol to tracker and display it
                      document.getElementById(cryptoDashTrackerID + "-changepcthour").innerHTML = '<i class="fa fa-angle-double-down"></i> ' + "H: " + data['DISPLAY'][cryptoDashTrackerID][CryptoDashCurrency]['CHANGEPCTHOUR'] + "%";
                      // set text red color and shadow for status symbol 
                      document.getElementById(cryptoDashTrackerID + "-changepcthour").querySelectorAll(".fa-angle-double-down").forEach((element) => {
                        element.style.setProperty('text-shadow', "0px 0px 8px #000");
                        element.style.setProperty('color', "#F73718");
                      });
                    }
  
                    
  
  
                  } catch (e) {
                    //console.error("Data not available for tracker: " + cryptoDashTrackerID);
                    //console.error(e);
                  }

                } catch (e) {
                  console.error(e);
                  showCryptoDashNotification(e, 10000);
                }
    
              });



            }
            
            
              

          } catch(e) {
            console.error(e);
            showCryptoDashNotification(e, 10000);
          }

          //return data;

        };

        document.getElementById('cryptodash-refresh-icon').classList.remove("fa-spin");
        
            
  
           
          
      } catch(e) {
        console.error(e);
        showCryptoDashNotification(e, -1, true);
      }
    
    } catch(e) {
      console.error(e);
      showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Crypto Compare API Error</strong> <br>` + e, -1, true);
    }
    

  }

  if (CryptoDashDataSource === "LiveCoinWatchAPI" ) {
    
    showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Live Coin Watch API Error</strong> <br>` + `Functionality not yet implemented`, -1, true);
    

  }

  if (CryptoDashDataSource === "CoinMarketCapAPI" ) {
    
    showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Coin Market Cap API Error</strong> <br>` + `Functionality not yet implemented`, -1, true);
    
  }

  
}

// stop the tracker data auto refresh 
function stopAutoCryptoDashFetchTrackerData() {
  clearInterval(autoDataPull);
  
}

// Notification Orientation and Location
(function () {

  var CryptoDashNotificationOrientationTop = document.getElementById('cryptodash-notification-orientation-top');
  var CryptoDashNotificationOrientationBottom = document.getElementById('cryptodash-notification-orientation-bottom');

  var CryptoDashNotificationLocationLeft = document.getElementById('cryptodash-notification-location-left');
  var CryptoDashNotificationLocationRight = document.getElementById('cryptodash-notification-location-right');

  if (!CryptoDashNotificationOrientationTop || !CryptoDashNotificationOrientationBottom) {
    CryptoDashNotificationOrientationBottom.checked = true;
    return;
  }

  if (!CryptoDashNotificationLocationLeft || !CryptoDashNotificationLocationRight) {
    CryptoDashNotificationLocationRight.checked = true;
    return;
  }

  function CryptoDashNotificationOrientationTopToggle(){
    if (CryptoDashNotificationOrientationTop.checked) {
      window.localStorage.setItem("CryptoDashNotificationOrientation", "top");
      CryptoDashNotificationOrientation = window.localStorage.getItem("CryptoDashNotificationOrientation");
      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Notifications orientation set to ` + CryptoDashNotificationOrientation, 3000);
    }
  }

  function CryptoDashNotificationOrientationBottomToggle(){
    if (CryptoDashNotificationOrientationBottom.checked) {
      window.localStorage.setItem("CryptoDashNotificationOrientation", "bottom");
      CryptoDashNotificationOrientation = window.localStorage.getItem("CryptoDashNotificationOrientation");
      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Notifications orientation set to ` + CryptoDashNotificationOrientation, 3000);
    }
  }

  function CryptoDashNotificationLocationLeftToggle(){
    if (CryptoDashNotificationLocationLeft.checked) {
      window.localStorage.setItem("CryptoDashNotificationLocation", "left");
      CryptoDashNotificationLocation = window.localStorage.getItem("CryptoDashNotificationLocation");
      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Notifications location set to ` + CryptoDashNotificationLocation, 3000);
    }
  }

  function CryptoDashNotificationLocationRightToggle(){
    if (CryptoDashNotificationLocationRight.checked) {
      window.localStorage.setItem("CryptoDashNotificationLocation", "right");
      CryptoDashNotificationLocation = window.localStorage.getItem("CryptoDashNotificationLocation");
      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Notifications location set to ` + CryptoDashNotificationLocation, 3000);
    }
  }



  function setup() {
    var CryptoDashNotificationOrientation = window.localStorage.getItem("CryptoDashNotificationOrientation");
    var CryptoDashNotificationLocation = window.localStorage.getItem("CryptoDashNotificationLocation");

    if (CryptoDashNotificationOrientation == null) {
      window.localStorage.setItem("CryptoDashNotificationOrientation", "bottom");
    }

    if (CryptoDashNotificationOrientation == "top") {
      CryptoDashNotificationOrientationTop.checked = true;
    }

    if (CryptoDashNotificationOrientation == "bottom") {
      CryptoDashNotificationOrientationBottom.checked = true;
    }

    if (CryptoDashNotificationLocation == null) {
      window.localStorage.setItem("CryptoDashNotificationLocation", "right");
    }
    
    if (CryptoDashNotificationLocation == "left") {
      CryptoDashNotificationLocationLeft.checked = true;
    }

    if (CryptoDashNotificationLocation == "right") {
      CryptoDashNotificationLocationRight.checked = true;
    }

    CryptoDashNotificationOrientationTop.addEventListener("change", CryptoDashNotificationOrientationTopToggle);
    CryptoDashNotificationOrientationBottom.addEventListener("change", CryptoDashNotificationOrientationBottomToggle);
    CryptoDashNotificationLocationLeft.addEventListener("change", CryptoDashNotificationLocationLeftToggle);
    CryptoDashNotificationLocationRight.addEventListener("change", CryptoDashNotificationLocationRightToggle);

    CryptoDashNotificationOrientationBottomToggle();
    CryptoDashNotificationLocationRightToggle();

  }

  setup();

})();

// Data auto refresh switch
(function () {
  let CryptoDashDataRefreshSwitch = document.getElementById("CryptoDashDataRefreshSwitch");
  if (!CryptoDashDataRefreshSwitch) {
    return;
  }

  function autoRefresh() {
    document.getElementById("refreshRanger").removeAttribute("disabled");
    if (CryptoDashDataRefreshSwitch.checked) {
      CryptoDashDataRefreshSwitch.checked = true;
    }
    window.localStorage.setItem("CryptoDashDataRefreshSwitch", "Auto");
    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Data set to refresh automatically`, 3000);
    
    var autoRefreshRanger = document.getElementById("refreshRanger");
    document.getElementById("dataRefreshSpan").innerHTML = autoRefreshRanger.value / 10 + "s";

    var CryptoDashAutoRefresh = window.localStorage.getItem('CryptoDashAutoRefresh');

    if (CryptoDashAutoRefresh) {
      
      autoRefreshRanger.value = CryptoDashAutoRefresh;
      // trigger the data pull with auto refresh
      autoCryptoDashFetchTrackerData();

      document.getElementById("dataRefreshSpan").innerHTML = CryptoDashAutoRefresh / 10 + "s";

      document.getElementById("cryptodash-refresh-button").innerHTML = `<i id ="cryptodash-refresh-icon" class="fa fa-refresh "></i> Auto`;

    } else {
      autoRefreshRanger.value = 0;
      autoRefreshRanger.title = autoRefreshRanger.value;
      document.getElementById("dataRefreshSpan").innerHTML = "N/A";
    }
    
  }

  function manualRefresh() {

    document.getElementById("refreshRanger").disabled = true;

    if (CryptoDashDataRefreshSwitch.checked) {
      CryptoDashDataRefreshSwitch.checked = false;
    }
    localStorage.setItem("CryptoDashDataRefreshSwitch", "Manual");
    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Data set to refresh manually`, 3000);
    document.getElementById("dataRefreshSpan").innerHTML = "N/A"; 
    document.getElementById("cryptodash-refresh-button").innerHTML = `<i id ="cryptodash-refresh-icon" class="fa fa-refresh "></i>`;
    stopAutoCryptoDashFetchTrackerData();
  }

  function onToggleMode() {
    if (CryptoDashDataRefreshSwitch.checked) {
      autoRefresh();
    } else {
      manualRefresh();
    }
  }

  function setup() {
    var settings = window.localStorage.getItem("CryptoDashDataRefreshSwitch");
    if (settings == null) {
      window.localStorage.setItem("CryptoDashDataRefreshSwitch", "Manual");
    }
    
    if (settings == "Auto") {
      CryptoDashDataRefreshSwitch.checked = true;
    }
    
    CryptoDashDataRefreshSwitch.addEventListener("change", onToggleMode);
    onToggleMode();
  }
  
  setup();

})();

// CryptoDash Currency selector
(function () {

  var CryptoDashCurrencyUSD = document.getElementById("cryptodash-currency-usd");
  var CryptoDashCurrencyEUR = document.getElementById("cryptodash-currency-eur");
  var CryptoDashCurrencyGBP = document.getElementById("cryptodash-currency-gbp");

  if (!CryptoDashCurrencyUSD || !CryptoDashCurrencyEUR || !CryptoDashCurrencyGBP) {
    CryptoDashCurrencyUSD.checked = true;
    return;
  }

  function USDToggle() {
    if (CryptoDashCurrencyUSD.checked) {
      window.localStorage.setItem("CryptoDashCurrency", "USD");
      CryptoDashCurrency = window.localStorage.getItem("CryptoDashCurrency");
      manualCryptoDashFetchTrackerData();
      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Currency set to USD`, 3000);

    }
  }

  function EURToggle() {
    if (CryptoDashCurrencyEUR.checked) {
      window.localStorage.setItem("CryptoDashCurrency", "EUR");
      CryptoDashCurrency = window.localStorage.getItem("CryptoDashCurrency");
      manualCryptoDashFetchTrackerData();
      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Currency set to EUR`, 3000);
      
    }
  }

  function GBPToggle() {
    if (CryptoDashCurrencyGBP.checked) {
      window.localStorage.setItem("CryptoDashCurrency", "GBP");
      CryptoDashCurrency = window.localStorage.getItem("CryptoDashCurrency");
      manualCryptoDashFetchTrackerData();
      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Currency set to GBP`, 3000);
      
    }
  }


  function setup() {
    var CryptoDashCurrency = window.localStorage.getItem("CryptoDashCurrency");

    if (CryptoDashCurrency == null) {
      window.localStorage.setItem("CryptoDashCurrency", "USD");
    }
    
    if (CryptoDashCurrency == "USD") {
      CryptoDashCurrencyUSD.checked = true;
    }

    if (CryptoDashCurrency == "EUR") {
      CryptoDashCurrencyEUR.checked = true;
    }

    if (CryptoDashCurrency == "GBP") {
      CryptoDashCurrencyGBP.checked = true;
    }
    
    CryptoDashCurrencyUSD.addEventListener("change", USDToggle);
    CryptoDashCurrencyEUR.addEventListener("change", EURToggle);
    CryptoDashCurrencyGBP.addEventListener("change", GBPToggle);

    USDToggle();
  }
  
  setup();


})();


// CryptoDash Background Selector
(function () {


  function GradientHD() {
    // Set localStorage background info
    window.localStorage.setItem("CryptoDashBackground", "GradientHD");

    // Change body class with selected background
    document.querySelector("body").classList.remove("cryptodash-bg-simple", "cryptodash-bg-custom", "cryptodash-bg-image-gradient-4k", "cryptodash-bg-image-abstract-hd", "cryptodash-bg-image-abstract-4k");
    document.querySelector("body").classList.add("cryptodash-bg-image-gradient-hd");
    
    // Change tab button status
    document.getElementById("cryptodash-bg-simple-button").classList.remove("active");
    document.getElementById("cryptodash-bg-gradient-button").classList.add("active");
    document.getElementById("cryptodash-bg-abstract-button").classList.remove("active");

    // Change tab status
    document.getElementById("cryptodash-bg-simple-tab").classList.remove("active", "show");
    document.getElementById("cryptodash-bg-gradient-tab").classList.add("active", "show");
    document.getElementById("cryptodash-bg-abstract-tab").classList.remove("active", "show");

    // Change tab background button status
    document.getElementById("cryptodash-bg-simple-color").innerHTML = 'Default Color';
    document.getElementById("cryptodash-bg-custom-color").innerHTML = 'Random';
    document.getElementById("cryptodash-bg-gradient-hd").innerHTML = '<i class="fa fa-check"></i> HD (1920x1080)';
    document.getElementById("cryptodash-bg-gradient-4k").innerHTML = '4K (3840x2160)';
    document.getElementById("cryptodash-bg-abstract-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-abstract-4k").innerHTML = '4K (3840x2160)';

    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Background set to Gradient HD`, 3000);

    var currentbg = document.querySelector('.cryptodash-bg-image-gradient-hd').style.backgroundImage.slice(5, -2);
    document.getElementById("cryptodash-download-bg").innerHTML = currentbg;

  }

  function Gradient4K() {
    // Set localStorage background info
    window.localStorage.setItem("CryptoDashBackground", "Gradient4K");

    // Change body class with selected background
    document.querySelector("body").classList.remove("cryptodash-bg-simple", "cryptodash-bg-custom", "cryptodash-bg-image-gradient-hd", "cryptodash-bg-image-abstract-hd", "cryptodash-bg-image-abstract-4k");
    document.querySelector("body").classList.add("cryptodash-bg-image-gradient-4k");

    // Change tab button status
    document.getElementById("cryptodash-bg-simple-button").classList.remove("active");
    document.getElementById("cryptodash-bg-gradient-button").classList.add("active");
    document.getElementById("cryptodash-bg-abstract-button").classList.remove("active");

    // Change tab status
    document.getElementById("cryptodash-bg-simple-tab").classList.remove("active", "show");
    document.getElementById("cryptodash-bg-gradient-tab").classList.add("active", "show");
    document.getElementById("cryptodash-bg-abstract-tab").classList.remove("active", "show");

    // Change tab background button status
    document.getElementById("cryptodash-bg-simple-color").innerHTML = 'Default Color';
    document.getElementById("cryptodash-bg-custom-color").innerHTML = 'Random Color';
    document.getElementById("cryptodash-bg-gradient-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-gradient-4k").innerHTML = '<i class="fa fa-check"></i> 4K (3840x2160)';
    document.getElementById("cryptodash-bg-abstract-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-abstract-4k").innerHTML = '4K (3840x2160)';

    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Background set to Gradient 4K`, 3000);
  }

  function AbstractHD() {
    // Set localStorage background info
    window.localStorage.setItem("CryptoDashBackground", "AbstractHD");

    // Change body class with selected background
    document.querySelector("body").classList.remove("cryptodash-bg-simple", "cryptodash-bg-custom", "cryptodash-bg-image-gradient-hd", "cryptodash-bg-image-gradient-4k", "cryptodash-bg-image-abstract-4k");
    document.querySelector("body").classList.add("cryptodash-bg-image-abstract-hd");

    // Change tab button status
    document.getElementById("cryptodash-bg-simple-button").classList.remove("active");
    document.getElementById("cryptodash-bg-gradient-button").classList.remove("active");
    document.getElementById("cryptodash-bg-abstract-button").classList.add("active");
    
    // Change tab status
    document.getElementById("cryptodash-bg-simple-tab").classList.remove("active", "show");
    document.getElementById("cryptodash-bg-gradient-tab").classList.remove("active", "show");
    document.getElementById("cryptodash-bg-abstract-tab").classList.add("active", "show");
    
    // Change tab background button status
    document.getElementById("cryptodash-bg-simple-color").innerHTML = 'Default Color';
    document.getElementById("cryptodash-bg-custom-color").innerHTML = 'Random Color';
    document.getElementById("cryptodash-bg-gradient-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-gradient-4k").innerHTML = '4K (3840x2160)';
    document.getElementById("cryptodash-bg-abstract-hd").innerHTML = '<i class="fa fa-check"></i> HD (1920x1080)';
    document.getElementById("cryptodash-bg-abstract-4k").innerHTML = '4K (3840x2160)';

    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Background set to Abstract HD`, 3000);
  }

  function Abstract4K() {
    // Set localStorage background info
    window.localStorage.setItem("CryptoDashBackground", "Abstract4K");

    // Change body class with selected background
    document.querySelector("body").classList.remove("cryptodash-bg-simple", "cryptodash-bg-custom", "cryptodash-bg-image-gradient-hd", "cryptodash-bg-image-gradient-4k", "cryptodash-bg-image-abstract-hd");
    document.querySelector("body").classList.add("cryptodash-bg-image-abstract-4k");

    // Change tab button status
    document.getElementById("cryptodash-bg-simple-button").classList.remove("active");
    document.getElementById("cryptodash-bg-gradient-button").classList.remove("active");
    document.getElementById("cryptodash-bg-abstract-button").classList.add("active");

    // Change tab status
    document.getElementById("cryptodash-bg-simple-tab").classList.remove("active", "show");
    document.getElementById("cryptodash-bg-gradient-tab").classList.remove("active", "show");
    document.getElementById("cryptodash-bg-abstract-tab").classList.add("active", "show");
    
    // Change tab background button status
    document.getElementById("cryptodash-bg-simple-color").innerHTML = 'Default Color';
    document.getElementById("cryptodash-bg-custom-color").innerHTML = 'Random Color';    
    document.getElementById("cryptodash-bg-gradient-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-gradient-4k").innerHTML = '4K (3840x2160)';
    document.getElementById("cryptodash-bg-abstract-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-abstract-4k").innerHTML = '<i class="fa fa-check"></i> 4K (3840x2160)';

    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Background set to Abstract 4K`, 3000);
  }

  function simpleCryptoDashBackgroundColor() {
    // Set localStorage background info
    window.localStorage.setItem("CryptoDashBackground", "Simple");

    // Change body class with selected background
    document.querySelector("body").classList.remove("cryptodash-bg-custom", "cryptodash-bg-image-gradient-hd", "cryptodash-bg-image-gradient-4k", "cryptodash-bg-image-abstract-hd", "cryptodash-bg-image-abstract-4k");
    document.querySelector("body").classList.add("cryptodash-bg-simple");

    // Change tab button status
    document.getElementById("cryptodash-bg-simple-button").classList.add("active");
    document.getElementById("cryptodash-bg-gradient-button").classList.remove("active");
    document.getElementById("cryptodash-bg-abstract-button").classList.remove("active");

    // Change tab status
    document.getElementById("cryptodash-bg-simple-tab").classList.add("active", "show");
    document.getElementById("cryptodash-bg-gradient-tab").classList.remove("active", "show");
    document.getElementById("cryptodash-bg-abstract-tab").classList.remove("active", "show");
    
    // Change tab background button status
    document.getElementById("cryptodash-bg-simple-color").innerHTML = '<i class="fa fa-check"></i> Default Color';
    document.getElementById("cryptodash-bg-custom-color").innerHTML = 'Random Color';    
    document.getElementById("cryptodash-bg-gradient-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-gradient-4k").innerHTML = '4K (3840x2160)';
    document.getElementById("cryptodash-bg-abstract-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-abstract-4k").innerHTML = '4K (3840x2160)';

    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Background set to Simple Color (Default)`, 3000);
  }

  function customCryptoDashBackgroundColor() {

    const hexCryptoDashColorCode = [ 0,	1, 2,	3,	4,	5,	6,	7,	8,	9, "a", "b", "c", "d", "e", "f"];

    const getRandomArray = () => {
      return Math.floor(Math.random() * hexCryptoDashColorCode.length);
    };

    let hexCryptoDashColorName = "#";

    for (let i = 0; i < 6; i++) {
      hexCryptoDashColorName += hexCryptoDashColorCode[getRandomArray()];
    }

    // Set localStorage background info
    window.localStorage.setItem("CryptoDashBackground", hexCryptoDashColorName);

    // Change body class with selected background
    document.querySelector("body").classList.remove("cryptodash-bg-simple", "cryptodash-bg-custom", "cryptodash-bg-image-gradient-hd", "cryptodash-bg-image-gradient-4k", "cryptodash-bg-image-abstract-hd", "cryptodash-bg-image-abstract-4k");
    document.querySelector("body").classList.add("cryptodash-bg-custom");

    document.documentElement.style.setProperty('--cryptodash-main-bg-color', hexCryptoDashColorName);

    // Change tab button status
    document.getElementById("cryptodash-bg-simple-button").classList.add("active");
    document.getElementById("cryptodash-bg-gradient-button").classList.remove("active");
    document.getElementById("cryptodash-bg-abstract-button").classList.remove("active");

    // Change tab status
    document.getElementById("cryptodash-bg-simple-tab").classList.add("active", "show");
    document.getElementById("cryptodash-bg-gradient-tab").classList.remove("active", "show");
    document.getElementById("cryptodash-bg-abstract-tab").classList.remove("active", "show");
    
    // Change tab background button status
    document.getElementById("cryptodash-bg-simple-color").innerHTML = 'Default';
    document.getElementById("cryptodash-bg-custom-color").innerHTML = '<i class="fa fa-check"></i> Random (' + hexCryptoDashColorName + ')';    
    document.getElementById("cryptodash-bg-gradient-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-gradient-4k").innerHTML = '4K (3840x2160)';
    document.getElementById("cryptodash-bg-abstract-hd").innerHTML = 'HD (1920x1080)';
    document.getElementById("cryptodash-bg-abstract-4k").innerHTML = '4K (3840x2160)';

    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Background set to Random Color (`+ hexCryptoDashColorName + `)`, 3000);
  }



  function setup() {
    var CryptoDashBackground = window.localStorage.getItem("CryptoDashBackground");
    var CryptoDashBGGradientHD = document.getElementById("cryptodash-bg-gradient-hd");
    var CryptoDashBGGradient4K = document.getElementById("cryptodash-bg-gradient-4k");
    var CryptoDashBGAbstractHD = document.getElementById("cryptodash-bg-abstract-hd");
    var CryptoDashBGAbstract4K = document.getElementById("cryptodash-bg-abstract-4k");
    var CryptoDashBGCustomColor = document.getElementById("cryptodash-bg-custom-color");
    var CryptoDashBGSimpleColor = document.getElementById("cryptodash-bg-simple-color");
    
    var checkhex = /^#([0-9a-f]{3}){1,2}$/i;

    if (CryptoDashBackground == null) {
      window.localStorage.setItem("CryptoDashBackground", "Simple");
      simpleCryptoDashBackgroundColor();
    }

    showCryptoDashNotification(`<i class="fa fa-picture-o"></i> Loading Background...`, 3000);
    
    if (CryptoDashBackground == "GradientHD") {
      // Change body class with selected background
      document.querySelector("body").classList.add("cryptodash-bg-image-gradient-hd");
      document.getElementById("cryptodash-bg-gradient-button").classList.add("active");
      document.getElementById("cryptodash-bg-simple-button").classList.remove("active");
      document.getElementById("cryptodash-bg-simple-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-gradient-tab").classList.add("active", "show");
      document.getElementById("cryptodash-bg-abstract-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-gradient-hd").innerHTML = '<i class="fa fa-check"></i> HD (1920x1080)';
    }

    if (CryptoDashBackground == "Gradient4K") {
      // Change body class with selected background
      document.querySelector("body").classList.add("cryptodash-bg-image-gradient-4k");
      document.getElementById("cryptodash-bg-gradient-button").classList.add("active");
      document.getElementById("cryptodash-bg-simple-button").classList.remove("active");
      document.getElementById("cryptodash-bg-simple-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-gradient-tab").classList.add("active", "show");
      document.getElementById("cryptodash-bg-abstract-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-gradient-4k").innerHTML = '<i class="fa fa-check"></i> 4K (3840x2160)';
    }

    if (CryptoDashBackground == "AbstractHD") {
      // Change body class with selected background
      document.querySelector("body").classList.add("cryptodash-bg-image-abstract-hd");
      document.getElementById("cryptodash-bg-abstract-button").classList.add("active");
      document.getElementById("cryptodash-bg-simple-button").classList.remove("active");
      document.getElementById("cryptodash-bg-simple-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-gradient-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-abstract-tab").classList.add("active", "show");
      document.getElementById("cryptodash-bg-abstract-hd").innerHTML = '<i class="fa fa-check"></i> HD (1920x1080)';
    }

    if (CryptoDashBackground == "Abstract4K") {
      // Change body class with selected background
      document.querySelector("body").classList.add("cryptodash-bg-image-abstract-4k");
      document.getElementById("cryptodash-bg-abstract-button").classList.add("active");
      document.getElementById("cryptodash-bg-simple-button").classList.remove("active");
      document.getElementById("cryptodash-bg-simple-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-gradient-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-abstract-tab").classList.add("active", "show");
      document.getElementById("cryptodash-bg-abstract-4k").innerHTML = '<i class="fa fa-check"></i> 4K (3840x2160)';
    }

    if (CryptoDashBackground == "Simple") {
      // Change body class with selected background 
      document.querySelector("body").classList.add("cryptodash-bg-simple");
      document.getElementById("cryptodash-bg-simple-button").classList.add("active");
      document.getElementById("cryptodash-bg-simple-tab").classList.add("active", "show");
      document.getElementById("cryptodash-bg-gradient-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-abstract-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-simple-color").innerHTML = '<i class="fa fa-check"></i> Default Color';

    } 
    
    if (checkhex.test(CryptoDashBackground)) {
      // Change body class with selected background 
      document.querySelector("body").classList.add("cryptodash-bg-custom");

      document.documentElement.style.setProperty('--cryptodash-main-bg-color', CryptoDashBackground);

      document.getElementById("cryptodash-bg-simple-button").classList.add("active");
      document.getElementById("cryptodash-bg-simple-tab").classList.add("active", "show");
      document.getElementById("cryptodash-bg-gradient-tab").classList.remove("active", "show");
      document.getElementById("cryptodash-bg-abstract-tab").classList.remove("active", "show");

      document.getElementById("cryptodash-bg-custom-color").innerHTML = '<i class="fa fa-check"></i> Random (' + CryptoDashBackground + ')';    

    }

    CryptoDashBGCustomColor.addEventListener("click", customCryptoDashBackgroundColor);
    CryptoDashBGSimpleColor.addEventListener("click", simpleCryptoDashBackgroundColor);

    CryptoDashBGGradientHD.addEventListener("click", GradientHD);
    CryptoDashBGGradient4K.addEventListener("click", Gradient4K);
    CryptoDashBGAbstractHD.addEventListener("click", AbstractHD);
    CryptoDashBGAbstract4K.addEventListener("click", Abstract4K);
    

  }
  setup();

})();

// CryptoDash Data Source Selector
(function () {

  var CryptoDashDataSourceCryptoCompareFree = document.getElementById("cryptodash-datasource-cryptocompare-free");
  var CryptoDashDataSourceCryptoCompareAPI = document.getElementById("cryptodash-datasource-cryptocompare-api");
  var CryptoDashDataSourceLiveCoinWatchAPI = document.getElementById("cryptodash-datasource-livecoinwatch-api");
  var CryptoDashDataSourceCoinMarketCapAPI = document.getElementById("cryptodash-datasource-coinmarketcap-api");

  var CryptoDashDataSourceAPIKey = document.getElementById("cryptodash-apikey");
  var CryptoDashDataSourceAPIKeyButton= document.getElementById('cryptodash-apikey-button');

  if (!CryptoDashDataSourceCryptoCompareFree || !CryptoDashDataSourceCryptoCompareAPI || !CryptoDashDataSourceLiveCoinWatchAPI || !CryptoDashDataSourceCoinMarketCapAPI) {
    CryptoDashDataSourceCryptoCompareFree.checked = true;
    return;
  }

  function setCryptoDashDataSourceCryptoCompareFree() {
    if (CryptoDashDataSourceCryptoCompareFree.checked) {
      window.localStorage.setItem("CryptoDashDataSource", "CryptoCompareFree");
      var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
      
      //manualCryptoDashFetchTrackerData();

      var disabledAttributeInput = document.createAttribute("disabled");
      var disabledAttributeButton = document.createAttribute("disabled");
    
      CryptoDashDataSourceAPIKey.setAttributeNode(disabledAttributeInput);
      CryptoDashDataSourceAPIKeyButton.setAttributeNode(disabledAttributeButton);
      

      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Data Source set to Crypto Compare Free`, 3000);

    }
  }

  function setCryptoDashDataSourceCryptoCompareAPI() {
    if (CryptoDashDataSourceCryptoCompareAPI.checked) {
      window.localStorage.setItem("CryptoDashDataSource", "CryptoCompareAPI");
      var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
      //manualCryptoDashFetchTrackerData();

      CryptoDashDataSourceAPIKey.removeAttribute("disabled");
      CryptoDashDataSourceAPIKeyButton.removeAttribute("disabled");

      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Data Source set to Crypto Compare API`, 3000);
      
    }
  }

  function setCryptoDashDataSourceLiveCoinWatchAPI() {
    if (CryptoDashDataSourceLiveCoinWatchAPI.checked) {
      window.localStorage.setItem("CryptoDashDataSource", "LiveCoinWatchAPI");
      var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
      //manualCryptoDashFetchTrackerData();
      
      CryptoDashDataSourceAPIKey.removeAttribute("disabled");
      CryptoDashDataSourceAPIKeyButton.removeAttribute("disabled");

      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Data Source set to Live Coin Watch `, 3000);
      

    }
  }

  function setCryptoDashDataSourceCoinMarketCapAPI() {
    if (CryptoDashDataSourceCoinMarketCapAPI.checked) {
      window.localStorage.setItem("CryptoDashDataSource", "CoinMarketCapAPI");
      var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");
      //manualCryptoDashFetchTrackerData();

      CryptoDashDataSourceAPIKey.removeAttribute("disabled");
      CryptoDashDataSourceAPIKeyButton.removeAttribute("disabled");

      showCryptoDashNotification(`<i class="fa fa-info-circle"></i> Data Source set to Coin Market Cap `, 3000);
      
    }
  }


  function setup() {
    var CryptoDashDataSource = window.localStorage.getItem("CryptoDashDataSource");

    if (CryptoDashDataSource == null) {
      window.localStorage.setItem("CryptoDashDataSource", "CryptoCompareFree");
    }
    
    if (CryptoDashDataSource == "CryptoCompareFree") {
      CryptoDashDataSourceCryptoCompareFree.checked = true;
      var disabledAttributeInput = document.createAttribute("disabled");
      var disabledAttributeButton = document.createAttribute("disabled");
    
      CryptoDashDataSourceAPIKey.setAttributeNode(disabledAttributeInput);
      CryptoDashDataSourceAPIKeyButton.setAttributeNode(disabledAttributeButton);
    }

    if (CryptoDashDataSource == "CryptoCompareAPI") {
      CryptoDashDataSourceCryptoCompareAPI.checked = true;
      CryptoDashDataSourceAPIKey.removeAttribute("disabled");
      CryptoDashDataSourceAPIKeyButton.removeAttribute("disabled");
    }

    if (CryptoDashDataSource == "LiveCoinWatchAPI") {
      CryptoDashDataSourceLiveCoinWatchAPI.checked = true;
      CryptoDashDataSourceAPIKey.removeAttribute("disabled");
      CryptoDashDataSourceAPIKeyButton.removeAttribute("disabled");
    }

    if (CryptoDashDataSource == "CoinMarketCapAPI") {
      CryptoDashDataSourceCoinMarketCapAPI.checked = true;
      CryptoDashDataSourceAPIKey.removeAttribute("disabled");
      CryptoDashDataSourceAPIKeyButton.removeAttribute("disabled");
    }
    
    CryptoDashDataSourceCryptoCompareFree.addEventListener("change", setCryptoDashDataSourceCryptoCompareFree);
    CryptoDashDataSourceCryptoCompareAPI.addEventListener("change", setCryptoDashDataSourceCryptoCompareAPI);
    CryptoDashDataSourceLiveCoinWatchAPI.addEventListener("change", setCryptoDashDataSourceLiveCoinWatchAPI);
    CryptoDashDataSourceCoinMarketCapAPI.addEventListener("change", setCryptoDashDataSourceCoinMarketCapAPI);

    setCryptoDashDataSourceCryptoCompareFree();
  }
  
  setup();


})();

// set API Key Input Field with saved API Key Data from Local Storage
(function () {
  var CryptoDashDataSourceAPIKeyInput = document.getElementById("cryptodash-apikey");
  var CryptoDashDataSourceAPIKey = window.localStorage.getItem("CryptoDashAPIKey");
  

    if (CryptoDashDataSourceAPIKey == null) {
      //showCryptoDashNotification(`<i class="fa fa-exclamation-circle"></i> <strong>Data Source Error</strong> <br>` + `Data Source API Key not found in Local Storage. <br> Update your API Key in Data Source.`, -1, true);
    } else {
      CryptoDashDataSourceAPIKeyInput.value = CryptoDashDataSourceAPIKey;

  
    }


})();

// frosting and defrosting the interface
(function () {

  var frostedCryptoDashThemeInput = document.getElementById("frostedCryptoDashTheme");

  var CryptoDashLightSwitch = window.localStorage.getItem("CryptoDashLightSwitch");

  if (!frostedCryptoDashThemeInput) {
    return;
  }

  function frostCryptoDash() {

    if (frostedCryptoDashThemeInput.checked) {
      frostedCryptoDashThemeInput.checked = true;
    }

    var CryptoDashLightSwitch = window.localStorage.getItem("CryptoDashLightSwitch");
    localStorage.setItem("CryptoDashFrostedThemeSwitch", "Frosted");
    showCryptoDashNotification(`<i class="fa fa-snowflake-o"></i> Frosted the theme`, 3000);
    
    // add frosting

    // .offcanvas backdrop-blur class
    document.querySelectorAll(".offcanvas").forEach((element) => {
      element.classList.add("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.remove("bg-dark");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.remove("bg-light");
      }

    });

    // modals backdrop-blur
    document.querySelectorAll(".modal-content").forEach((element) => {
      element.classList.add("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.remove("bg-dark");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.remove("bg-light");
      }

    });

    // select backdrop-blur
    document.querySelectorAll(".ts-dropdown-content").forEach((element) => {
      element.classList.add("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.remove("bg-dark");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.remove("bg-light");
      }

    });

    // select backdrop-blur
    document.querySelectorAll(".ts-control").forEach((element) => {
      //element.classList.add("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.remove("bg-dark");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.remove("bg-light");
      }

    });

    // select backdrop-blur
    document.querySelectorAll(".ts-dropdown").forEach((element) => {
      //element.classList.add("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.remove("bg-dark");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.remove("bg-light");
      }

    });

    


    // option text colors
    document.querySelectorAll(".option").forEach((element) => {
      if(CryptoDashLightSwitch == "dark") {
        //element.classList.add("text-light");
        //element.classList.add("text-light");
        element.classList.remove("text-light");
        element.classList.remove("text-dark");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.add("text-dark");
        //element.classList.add("text-dark");
      }
      
    });
    
    
    // .cryptodash-tracker tracker-backdrop-blur
    document.querySelectorAll(".cryptodash-tracker").forEach((element) => {
      element.classList.add("tracker-backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.remove("bg-dark");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.remove("bg-light");
      }

      CryptoDashGrid.synchronize();
      CryptoDashGrid.refreshItems();
      CryptoDashGrid.layout();

    });
   
    // #cryptodash-settings-button backdrop-blur
    document.querySelector("#cryptodash-settings-button").classList.add("backdrop-blur");

    // #cryptodash-refresh-button backdrop-blur
    document.querySelector("#cryptodash-refresh-button").classList.add("backdrop-blur");

    // # cryptodash-clock backdrop-blur
    document.querySelector("#cryptodash-clock").classList.add("backdrop-blur");


  }

  function defrostCryptoDash() {

    var CryptoDashLightSwitch = window.localStorage.getItem("CryptoDashLightSwitch");
    if (frostedCryptoDashThemeInput.checked) {
      frostedCryptoDashThemeInput.checked = false;
    }
    localStorage.setItem("CryptoDashFrostedThemeSwitch", "Defrosted");
    showCryptoDashNotification(`<i class="fa fa-fire"></i> Defrosted the theme`, 3000);
    
    // remove frosting
    
    // .offcanvas backdrop-blur class
    document.querySelectorAll(".offcanvas").forEach((element) => {
      element.classList.remove("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.add("bg-dark");
        //element.classList.add("text-light");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.add("bg-light");
        //element.classList.add("text-dark");
      }

    });

    // .modal backdrop-blur class
    document.querySelectorAll(".modal-content").forEach((element) => {
      element.classList.remove("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.add("bg-dark");
        //element.classList.add("text-light");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.add("bg-light");
        //element.classList.add("text-dark");
      }

    });

    // .select backdrop-blur class
    document.querySelectorAll(".ts-dropdown-content").forEach((element) => {
      element.classList.remove("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.add("bg-dark");
        //element.classList.add("text-light");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.add("bg-light");
        //element.classList.add("text-dark");
      }

    });

    // .select backdrop-blur class
    document.querySelectorAll(".ts-control").forEach((element) => {
      element.classList.remove("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.add("bg-dark");
        //element.classList.add("text-light");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.add("bg-light");
        //element.classList.add("text-dark");
      }

    });

    // .select backdrop-blur class
    document.querySelectorAll(".ts-dropdown").forEach((element) => {
      element.classList.remove("backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.add("bg-dark");
        element.classList.add("text-light");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.add("bg-light");
        element.classList.add("text-dark");
      }

    });

    // option text colors
    document.querySelectorAll(".option").forEach((element) => {
      if(CryptoDashLightSwitch == "dark") {
        //element.classList.add("text-light");
        //element.classList.add("text-light");
        element.classList.remove("text-light");
        element.classList.remove("text-dark");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.add("text-dark");
        //element.classList.add("text-dark");
      }
      
    });
    



    // .cryptodash-tracker tracker-backdrop-blur
    document.querySelectorAll(".cryptodash-tracker").forEach((element) => {
      element.classList.remove("tracker-backdrop-blur");

      if(CryptoDashLightSwitch == "dark") {
        element.classList.add("bg-dark");
        //element.classList.add("text-light");
      }

      if(CryptoDashLightSwitch == "light") {
        element.classList.add("bg-light");
        //element.classList.add("text-dark");
      }

      CryptoDashGrid.synchronize();
      CryptoDashGrid.refreshItems();
      CryptoDashGrid.layout();
      

    });
   
    // #cryptodash-settings-button backdrop-blur
    document.querySelector("#cryptodash-settings-button").classList.remove("backdrop-blur");

    // #cryptodash-refresh-button backdrop-blur
    document.querySelector("#cryptodash-refresh-button").classList.remove("backdrop-blur");

    // # cryptodash-clock backdrop-blur
    document.querySelector("#cryptodash-clock").classList.remove("backdrop-blur");

  }


  function onToggleMode() {
    if (frostedCryptoDashThemeInput.checked) {
      frostCryptoDash();
    } else {
      defrostCryptoDash();
    }
  }


  function setup() {
    var settings = window.localStorage.getItem("CryptoDashFrostedThemeSwitch");
    if (settings == null) {
      window.localStorage.setItem("CryptoDashFrostedThemeSwitch", "Frosted");
    }
    
    if (settings == "Frosted") {
      frostedCryptoDashThemeInput.checked = true;
    }

    if (settings == "Defrosted") {
      frostedCryptoDashThemeInput.checked = false;
    }
    
    frostedCryptoDashThemeInput.addEventListener("change", onToggleMode);
    onToggleMode();
  }

  setup();
})();

function setCryptoDashDataSourceAPIKey() {
  var CryptoDashDataSourceAPIKey = document.getElementById("cryptodash-apikey");

    window.localStorage.setItem("CryptoDashAPIKey", CryptoDashDataSourceAPIKey.value);
    showCryptoDashNotification(`<i class="fa fa-info-circle"></i> API Key successfully added`, 3000);

}

// window erorr 

/*
window.onerror = function(msg, url, line, col, error) {
  // Note that col & error are new to the HTML 5 spec and may not be 
  // supported in every browser.  It worked for me in Chrome.
  var extra = !col ? '' : '\ncolumn: ' + col;
  extra += !error ? '' : '\nerror: ' + error;

  // You can view the information in an alert to see things working like this:
  alert("Error: " + msg + "\nurl: " + url + "\nline: " + line + extra);


  Toastify({
    text: ` <div class="toast-body bordered "> <p>Error: ` + msg + `</p> </div> `,
    duration: 10000,
    className: "tracker-backdrop-blur",
    newWindow: true,
    close: false,
    gravity: "top", // `top` or `bottom`
    position: "right", // `left`, `center` or `right`
    stopOnFocus: true, // Prevents dismissing of toast on hover
    escapeMarkup: false,
    
    style: {
      boxShadow: "0px 0px 30px 5px rgba(0, 0, 0, 0.3),0px 0px 10px -30px rgba(0, 0, 0, 0.3),0px 0px 6px 3px rgba(0, 0, 0, 0.2)",
      borderRadius: "20px",
    },

    onClick: function(){} // Callback after click
  }).showToast();


  // TODO: Report this error via ajax so you can keep track
  //       of what pages have JS issues

  var suppressErrorAlert = true;
  // If you return true, then error alerts (like in older versions of 
  // Internet Explorer) will be suppressed.
  return suppressErrorAlert;
};
*/


/* Font resize 
https://github.com/adactio/FitText.js
*/
(function(){

  var addEvent = function (el, type, fn) {
    if (el.addEventListener)
      el.addEventListener(type, fn, false);
		else
			el.attachEvent('on'+type, fn);
  };
  
  var extend = function(obj,ext){
    for(var key in ext)
      if(ext.hasOwnProperty(key))
        obj[key] = ext[key];
    return obj;
  };

  window.fitText = function (el, kompressor, options) {

    var settings = extend({
      'minFontSize' : -1/0,
      'maxFontSize' : 1/0
    },options);

    var fit = function (el) {
      var compressor = kompressor || 1;

      var resizer = function () {
        el.style.fontSize = Math.max(Math.min(el.clientWidth / (compressor*10), parseFloat(settings.maxFontSize)), parseFloat(settings.minFontSize)) + 'px';
      };

      // Call once to set.
      resizer();

      // Bind events
      // If you have any js library which support Events, replace this part
      // and remove addEvent function (or use original jQuery version)
      addEvent(window, 'resize', resizer);
      addEvent(window, 'orientationchange', resizer);
    };

    if (el.length)
      for(var i=0; i<el.length; i++)
        fit(el[i]);
    else
      fit(el);

    // return set of elements
    return el;
  };
})();


// Helper function to convert numbers to plain string
function helperCryptoDashNumberToPlainString(num) {
  return (''+ +num).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,
    function(a,b,c,d,e) {
      return e < 0
        ? b + '0.' + Array(1-e-c.length).join(0) + c + d
        : b + c + d + Array(e-d.length+1).join(0);
    });
}

// Helper function to generate HTML Table from Javascript Arrays
function helperCryptoDashArrayToHTMLTable(data) {
  const keys = [...data.reduce((all, obj)=>{
      Object.keys(obj).forEach(key => all.add(key));
      return all;
  }, new Set())];

  const header = keys.map(key => `<th>${key}</th>`).join('')
  const tbody = data.map(row => keys.map(key => `<td>${row[key]}</td>`).join('')).map(row => `<tr>${row}</tr>`)

  return `<table>
      <thead><tr>${header}</tr></thead>
      <tbody>${tbody}</body>
  </table>`;
}

// Helper function to generate HTML Table from Javascript Objects
function helperCryptoDashObjectToHTMLTable(obj) {
  var html = '<table>';
  for (var key in obj) {
    var value = obj[key].toString();
    html += '<tr><td>' + key + '</td><td>' + value + '</tr>';
  }
  html += '</table>';
  return html;
}



pullCryptoDashCoinList();

// Initial call to update font size on first page load
updateCryptoDashTrackerFontSize();



</script>

</html>
